"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/activity-log/route";
exports.ids = ["app/api/activity-log/route"];
exports.modules = {

/***/ "./action-async-storage.external?8dda":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "./request-async-storage.external?3d59":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "./static-generation-async-storage.external?16bc":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Factivity-log%2Froute&page=%2Fapi%2Factivity-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Factivity-log%2Froute.ts&appDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Factivity-log%2Froute&page=%2Fapi%2Factivity-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Factivity-log%2Froute.ts&appDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_adeomosanya_Documents_ifa_professional_portal_ifa_platform_src_app_api_activity_log_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/activity-log/route.ts */ \"(rsc)/./src/app/api/activity-log/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/activity-log/route\",\n        pathname: \"/api/activity-log\",\n        filename: \"route\",\n        bundlePath: \"app/api/activity-log/route\"\n    },\n    resolvedPagePath: \"/Users/adeomosanya/Documents/ifa-professional-portal/ifa-platform/src/app/api/activity-log/route.ts\",\n    nextConfigOutput,\n    userland: _Users_adeomosanya_Documents_ifa_professional_portal_ifa_platform_src_app_api_activity_log_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/activity-log/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhY3Rpdml0eS1sb2clMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFjdGl2aXR5LWxvZyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFjdGl2aXR5LWxvZyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFkZW9tb3NhbnlhJTJGRG9jdW1lbnRzJTJGaWZhLXByb2Zlc3Npb25hbC1wb3J0YWwlMkZpZmEtcGxhdGZvcm0lMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGYWRlb21vc2FueWElMkZEb2N1bWVudHMlMkZpZmEtcHJvZmVzc2lvbmFsLXBvcnRhbCUyRmlmYS1wbGF0Zm9ybSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNtRDtBQUNoSTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3BsYW5uZXRpYy1wbGF0Zm9ybS8/YTk4NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvYWRlb21vc2FueWEvRG9jdW1lbnRzL2lmYS1wcm9mZXNzaW9uYWwtcG9ydGFsL2lmYS1wbGF0Zm9ybS9zcmMvYXBwL2FwaS9hY3Rpdml0eS1sb2cvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FjdGl2aXR5LWxvZy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FjdGl2aXR5LWxvZ1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWN0aXZpdHktbG9nL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2FkZW9tb3NhbnlhL0RvY3VtZW50cy9pZmEtcHJvZmVzc2lvbmFsLXBvcnRhbC9pZmEtcGxhdGZvcm0vc3JjL2FwcC9hcGkvYWN0aXZpdHktbG9nL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FjdGl2aXR5LWxvZy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Factivity-log%2Froute&page=%2Fapi%2Factivity-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Factivity-log%2Froute.ts&appDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/activity-log/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/activity-log/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _lib_logging_structured__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/logging/structured */ \"(rsc)/./src/lib/logging/structured.ts\");\n// src/app/api/activity-log/route.ts\n// Force dynamic rendering to prevent build-time errors\nconst dynamic = \"force-dynamic\";\n\n\n\n// GET - Fetch activity log for a client OR recent activities for dashboard\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const clientId = searchParams.get(\"clientId\");\n        const recent = searchParams.get(\"recent\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        // If requesting recent activities across all clients - aggregate from multiple sources\n        if (recent === \"true\") {\n            const allActivities = [];\n            // 1. Fetch from activity_log table\n            const { data: activityLogData } = await supabase.from(\"activity_log\").select(`\n          *,\n          client:clients(\n            id,\n            personal_details,\n            client_ref\n          )\n        `).order(\"date\", {\n                ascending: false\n            }).limit(50);\n            if (activityLogData) {\n                activityLogData.forEach((activity)=>{\n                    allActivities.push({\n                        id: activity.id,\n                        client_id: activity.client_id,\n                        action: activity.action,\n                        type: activity.type || \"activity\",\n                        date: activity.date,\n                        user_name: activity.user_name,\n                        clientName: activity.client ? `${activity.client.personal_details?.firstName || \"\"} ${activity.client.personal_details?.lastName || \"\"}`.trim() : \"Unknown Client\",\n                        clientRef: activity.client?.client_ref || null\n                    });\n                });\n            }\n            // 2. Fetch recent communications\n            const { data: commsData } = await supabase.from(\"client_communications\").select(`\n          id,\n          client_id,\n          communication_type,\n          subject,\n          communication_date,\n          created_by,\n          client:clients(\n            id,\n            personal_details,\n            client_ref\n          )\n        `).order(\"communication_date\", {\n                ascending: false\n            }).limit(30);\n            if (commsData) {\n                commsData.forEach((comm)=>{\n                    allActivities.push({\n                        id: `comm-${comm.id}`,\n                        client_id: comm.client_id,\n                        action: `${comm.communication_type || \"Communication\"}: \"${comm.subject || \"No subject\"}\"`,\n                        type: \"communication\",\n                        date: comm.communication_date,\n                        user_name: comm.created_by || null,\n                        clientName: comm.client ? `${comm.client.personal_details?.firstName || \"\"} ${comm.client.personal_details?.lastName || \"\"}`.trim() : \"Unknown Client\",\n                        clientRef: comm.client?.client_ref || null\n                    });\n                });\n            }\n            // 3. Fetch recent reviews\n            const { data: reviewsData } = await supabase.from(\"reviews\").select(`\n          id,\n          client_id,\n          review_type,\n          status,\n          created_at,\n          updated_at,\n          client:clients(\n            id,\n            personal_details,\n            client_ref\n          )\n        `).order(\"updated_at\", {\n                ascending: false\n            }).limit(30);\n            if (reviewsData) {\n                reviewsData.forEach((review)=>{\n                    const statusText = review.status === \"completed\" ? \"completed\" : review.status === \"overdue\" ? \"is overdue\" : \"scheduled\";\n                    allActivities.push({\n                        id: `review-${review.id}`,\n                        client_id: review.client_id,\n                        action: `${review.review_type || \"Review\"} ${statusText}`,\n                        type: \"review\",\n                        date: review.updated_at || review.created_at,\n                        user_name: null,\n                        clientName: review.client ? `${review.client.personal_details?.firstName || \"\"} ${review.client.personal_details?.lastName || \"\"}`.trim() : \"Unknown Client\",\n                        clientRef: review.client?.client_ref || null\n                    });\n                });\n            }\n            // 4. Fetch recently created/updated clients\n            const { data: clientsData } = await supabase.from(\"clients\").select(\"id, personal_details, client_ref, created_at, updated_at\").order(\"updated_at\", {\n                ascending: false\n            }).limit(20);\n            if (clientsData) {\n                clientsData.forEach((client)=>{\n                    const clientName = `${client.personal_details?.firstName || \"\"} ${client.personal_details?.lastName || \"\"}`.trim() || \"Unknown Client\";\n                    // Only add if created recently (within last 90 days) - as a \"client added\" activity\n                    const createdDate = new Date(client.created_at);\n                    const ninetyDaysAgo = new Date();\n                    ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90);\n                    if (createdDate > ninetyDaysAgo) {\n                        allActivities.push({\n                            id: `client-created-${client.id}`,\n                            client_id: client.id,\n                            action: \"Client added to system\",\n                            type: \"client_added\",\n                            date: client.created_at,\n                            user_name: null,\n                            clientName,\n                            clientRef: client.client_ref || null\n                        });\n                    }\n                });\n            }\n            // 5. Fetch recent suitability assessments\n            const { data: assessmentsData } = await supabase.from(\"suitability_assessments\").select(`\n          id,\n          client_id,\n          status,\n          created_at,\n          updated_at,\n          client:clients(\n            id,\n            personal_details,\n            client_ref\n          )\n        `).order(\"updated_at\", {\n                ascending: false\n            }).limit(20);\n            if (assessmentsData) {\n                assessmentsData.forEach((assessment)=>{\n                    const statusText = assessment.status === \"completed\" ? \"Suitability assessment completed\" : assessment.status === \"in_progress\" ? \"Suitability assessment started\" : \"Suitability assessment created\";\n                    allActivities.push({\n                        id: `assessment-${assessment.id}`,\n                        client_id: assessment.client_id,\n                        action: statusText,\n                        type: \"assessment\",\n                        date: assessment.updated_at || assessment.created_at,\n                        user_name: null,\n                        clientName: assessment.client ? `${assessment.client.personal_details?.firstName || \"\"} ${assessment.client.personal_details?.lastName || \"\"}`.trim() : \"Unknown Client\",\n                        clientRef: assessment.client?.client_ref || null\n                    });\n                });\n            }\n            // 6. Fetch recent Monte Carlo simulations\n            const { data: monteCarloData, error: mcError } = await supabase.from(\"monte_carlo_results\").select(`\n          id,\n          client_id,\n          scenario_id,\n          scenario_name,\n          created_at\n        `).order(\"created_at\", {\n                ascending: false\n            }).limit(20);\n            if (mcError) {\n                console.error(\"Error fetching Monte Carlo data:\", mcError);\n            }\n            if (monteCarloData && monteCarloData.length > 0) {\n                const monteCarloRows = monteCarloData;\n                // Get unique scenario IDs to fetch client info\n                const scenarioIds = [\n                    ...new Set(monteCarloRows.map((mc)=>mc.scenario_id).filter((id)=>Boolean(id)))\n                ];\n                // Fetch scenario -> client mapping\n                const { data: scenarioData } = await supabase.from(\"cash_flow_scenarios\").select(\"id, client_id, scenario_name\").in(\"id\", scenarioIds);\n                const scenarioMap = new Map((scenarioData || []).map((s)=>[\n                        s.id,\n                        s\n                    ]));\n                // Get all client IDs (direct + via scenario)\n                const clientIds = new Set();\n                monteCarloRows.forEach((mc)=>{\n                    if (mc.client_id) clientIds.add(mc.client_id);\n                    const scenario = mc.scenario_id ? scenarioMap.get(mc.scenario_id) : undefined;\n                    if (scenario?.client_id) clientIds.add(scenario.client_id);\n                });\n                // Fetch client names (only if we have client IDs)\n                let clientMap = new Map();\n                if (clientIds.size > 0) {\n                    const { data: clientsData } = await supabase.from(\"clients\").select(\"id, personal_details, client_ref\").in(\"id\", Array.from(clientIds));\n                    clientMap = new Map((clientsData || []).map((c)=>[\n                            c.id,\n                            c\n                        ]));\n                }\n                monteCarloRows.forEach((mc)=>{\n                    // Try direct client_id first, then fall back to scenario's client_id\n                    const scenario = mc.scenario_id ? scenarioMap.get(mc.scenario_id) : undefined;\n                    const clientId = mc.client_id || scenario?.client_id || null;\n                    const client = clientId ? clientMap.get(clientId) : null;\n                    // Include ALL Monte Carlo activities\n                    // If client is resolved, show client name; otherwise show as \"Projection Analysis\"\n                    if (client) {\n                        const firstName = client.personal_details?.firstName || client.personal_details?.first_name || \"\";\n                        const lastName = client.personal_details?.lastName || client.personal_details?.last_name || \"\";\n                        const clientName = `${firstName} ${lastName}`.trim();\n                        allActivities.push({\n                            id: `mc-${mc.id}`,\n                            client_id: clientId,\n                            action: `Monte Carlo simulation: ${mc.scenario_name || scenario?.scenario_name || \"Analysis completed\"}`,\n                            type: \"monte_carlo\",\n                            date: mc.created_at || new Date().toISOString(),\n                            user_name: null,\n                            clientName: clientName || \"Projection Analysis\",\n                            clientRef: client?.client_ref ?? null\n                        });\n                    } else {\n                        // No client linked - show as system-level activity\n                        allActivities.push({\n                            id: `mc-${mc.id}`,\n                            client_id: null,\n                            action: `Monte Carlo simulation: ${mc.scenario_name || scenario?.scenario_name || \"Analysis completed\"}`,\n                            type: \"monte_carlo\",\n                            date: mc.created_at || new Date().toISOString(),\n                            user_name: null,\n                            clientName: \"Projection Analysis\",\n                            clientRef: null\n                        });\n                    }\n                });\n            }\n            // Sort all activities by date descending and deduplicate\n            const seen = new Set();\n            const sortedActivities = allActivities.filter((a)=>{\n                // Deduplicate by action + client + date (rounded to minute)\n                const key = `${a.action}-${a.client_id}-${a.date?.slice(0, 16)}`;\n                if (seen.has(key)) return false;\n                seen.add(key);\n                return true;\n            }).sort((a, b)=>new Date(b.date).getTime() - new Date(a.date).getTime()).slice(0, limit);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                data: sortedActivities\n            });\n        }\n        // Regular client-specific activity log\n        if (!clientId) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Client ID is required\"\n            }, {\n                status: 400\n            });\n        }\n        const { data, error, count } = await supabase.from(\"activity_log\").select(\"*\", {\n            count: \"exact\"\n        }).eq(\"client_id\", clientId).order(\"date\", {\n            ascending: false\n        }).range(offset, offset + limit - 1);\n        if (error) {\n            _lib_logging_structured__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Error fetching activity log\", error, {\n                clientId\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Failed to fetch activity log\"\n            }, {\n                status: 500\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            data: data || [],\n            total: count || 0,\n            limit,\n            offset\n        });\n    } catch (error) {\n        _lib_logging_structured__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Error in GET /api/activity-log\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST - Create new activity log entry\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { clientId, action, type, userName } = body;\n        // Validate required fields\n        if (!clientId || !action) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Missing required fields\"\n            }, {\n                status: 400\n            });\n        }\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)(); // FIXED: Using await, no parameters\n        // Create the activity log entry matching your table structure\n        const { data, error } = await supabase.from(\"activity_log\").insert({\n            client_id: clientId,\n            action,\n            type: type || null,\n            user_name: userName || null,\n            date: new Date().toISOString()\n        }).select().single();\n        if (error) {\n            _lib_logging_structured__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Error creating activity log\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Failed to create activity log\"\n            }, {\n                status: 500\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            data\n        });\n    } catch (error) {\n        _lib_logging_structured__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Error in POST /api/activity-log\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPN0Qsa0ZBQVlBLENBQUNtRyxJQUFJLENBQ3RCO2dCQUFFdEMsT0FBTztZQUFnQyxHQUN6QztnQkFBRWIsUUFBUTtZQUFJO1FBRWxCO1FBRUEsT0FBT2hELGtGQUFZQSxDQUFDbUcsSUFBSSxDQUFDO1lBQ3ZCVSxTQUFTO1lBQ1Q3RjtRQUNGO0lBQ0YsRUFBRSxPQUFPNkMsT0FBTztRQUNkM0Qsd0RBQUdBLENBQUMyRCxLQUFLLENBQUMsbUNBQW1DQTtRQUM3QyxPQUFPN0Qsa0ZBQVlBLENBQUNtRyxJQUFJLENBQ3RCO1lBQUV0QyxPQUFPO1FBQXdCLEdBQ2pDO1lBQUViLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGxhbm5ldGljLXBsYXRmb3JtLy4vc3JjL2FwcC9hcGkvYWN0aXZpdHktbG9nL3JvdXRlLnRzP2NkZjYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2FwcC9hcGkvYWN0aXZpdHktbG9nL3JvdXRlLnRzXG4vLyBGb3JjZSBkeW5hbWljIHJlbmRlcmluZyB0byBwcmV2ZW50IGJ1aWxkLXRpbWUgZXJyb3JzXG5leHBvcnQgY29uc3QgZHluYW1pYyA9ICdmb3JjZS1keW5hbWljJ1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJ1xuaW1wb3J0IHsgbG9nIH0gZnJvbSAnQC9saWIvbG9nZ2luZy9zdHJ1Y3R1cmVkJ1xuXG5pbnRlcmZhY2UgQWdncmVnYXRlZEFjdGl2aXR5IHtcbiAgaWQ6IHN0cmluZ1xuICBjbGllbnRfaWQ6IHN0cmluZyB8IG51bGxcbiAgYWN0aW9uOiBzdHJpbmdcbiAgdHlwZTogc3RyaW5nXG4gIGRhdGU6IHN0cmluZ1xuICB1c2VyX25hbWU6IHN0cmluZyB8IG51bGxcbiAgY2xpZW50TmFtZTogc3RyaW5nXG4gIGNsaWVudFJlZjogc3RyaW5nIHwgbnVsbFxufVxuXG5pbnRlcmZhY2UgTW9udGVDYXJsb1JvdyB7XG4gIGlkOiBzdHJpbmdcbiAgY2xpZW50X2lkOiBzdHJpbmcgfCBudWxsXG4gIHNjZW5hcmlvX2lkOiBzdHJpbmcgfCBudWxsXG4gIHNjZW5hcmlvX25hbWU6IHN0cmluZyB8IG51bGxcbiAgY3JlYXRlZF9hdDogc3RyaW5nIHwgbnVsbFxufVxuXG5pbnRlcmZhY2UgQ2FzaEZsb3dTY2VuYXJpb1JvdyB7XG4gIGlkOiBzdHJpbmdcbiAgY2xpZW50X2lkOiBzdHJpbmcgfCBudWxsXG4gIHNjZW5hcmlvX25hbWU6IHN0cmluZyB8IG51bGxcbn1cblxuaW50ZXJmYWNlIENsaWVudFJvdyB7XG4gIGlkOiBzdHJpbmdcbiAgcGVyc29uYWxfZGV0YWlscz86IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsXG4gIGNsaWVudF9yZWY/OiBzdHJpbmcgfCBudWxsXG59XG5cbi8vIEdFVCAtIEZldGNoIGFjdGl2aXR5IGxvZyBmb3IgYSBjbGllbnQgT1IgcmVjZW50IGFjdGl2aXRpZXMgZm9yIGRhc2hib2FyZFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCBjbGllbnRJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2NsaWVudElkJyk7XG4gICAgY29uc3QgcmVjZW50ID0gc2VhcmNoUGFyYW1zLmdldCgncmVjZW50Jyk7XG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc1MCcpO1xuICAgIGNvbnN0IG9mZnNldCA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ29mZnNldCcpIHx8ICcwJyk7XG5cbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgLy8gSWYgcmVxdWVzdGluZyByZWNlbnQgYWN0aXZpdGllcyBhY3Jvc3MgYWxsIGNsaWVudHMgLSBhZ2dyZWdhdGUgZnJvbSBtdWx0aXBsZSBzb3VyY2VzXG4gICAgaWYgKHJlY2VudCA9PT0gJ3RydWUnKSB7XG4gICAgICBjb25zdCBhbGxBY3Rpdml0aWVzOiBBZ2dyZWdhdGVkQWN0aXZpdHlbXSA9IFtdXG5cbiAgICAgIC8vIDEuIEZldGNoIGZyb20gYWN0aXZpdHlfbG9nIHRhYmxlXG4gICAgICBjb25zdCB7IGRhdGE6IGFjdGl2aXR5TG9nRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2FjdGl2aXR5X2xvZycpXG4gICAgICAgIC5zZWxlY3QoYFxuICAgICAgICAgICosXG4gICAgICAgICAgY2xpZW50OmNsaWVudHMoXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHBlcnNvbmFsX2RldGFpbHMsXG4gICAgICAgICAgICBjbGllbnRfcmVmXG4gICAgICAgICAgKVxuICAgICAgICBgKVxuICAgICAgICAub3JkZXIoJ2RhdGUnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDUwKTtcblxuICAgICAgaWYgKGFjdGl2aXR5TG9nRGF0YSkge1xuICAgICAgICBhY3Rpdml0eUxvZ0RhdGEuZm9yRWFjaCgoYWN0aXZpdHk6IGFueSkgPT4ge1xuICAgICAgICAgIGFsbEFjdGl2aXRpZXMucHVzaCh7XG4gICAgICAgICAgICBpZDogYWN0aXZpdHkuaWQsXG4gICAgICAgICAgICBjbGllbnRfaWQ6IGFjdGl2aXR5LmNsaWVudF9pZCxcbiAgICAgICAgICAgIGFjdGlvbjogYWN0aXZpdHkuYWN0aW9uLFxuICAgICAgICAgICAgdHlwZTogYWN0aXZpdHkudHlwZSB8fCAnYWN0aXZpdHknLFxuICAgICAgICAgICAgZGF0ZTogYWN0aXZpdHkuZGF0ZSxcbiAgICAgICAgICAgIHVzZXJfbmFtZTogYWN0aXZpdHkudXNlcl9uYW1lLFxuICAgICAgICAgICAgY2xpZW50TmFtZTogYWN0aXZpdHkuY2xpZW50XG4gICAgICAgICAgICAgID8gYCR7YWN0aXZpdHkuY2xpZW50LnBlcnNvbmFsX2RldGFpbHM/LmZpcnN0TmFtZSB8fCAnJ30gJHthY3Rpdml0eS5jbGllbnQucGVyc29uYWxfZGV0YWlscz8ubGFzdE5hbWUgfHwgJyd9YC50cmltKClcbiAgICAgICAgICAgICAgOiAnVW5rbm93biBDbGllbnQnLFxuICAgICAgICAgICAgY2xpZW50UmVmOiBhY3Rpdml0eS5jbGllbnQ/LmNsaWVudF9yZWYgfHwgbnVsbFxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIDIuIEZldGNoIHJlY2VudCBjb21tdW5pY2F0aW9uc1xuICAgICAgY29uc3QgeyBkYXRhOiBjb21tc0RhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjbGllbnRfY29tbXVuaWNhdGlvbnMnKVxuICAgICAgICAuc2VsZWN0KGBcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBjbGllbnRfaWQsXG4gICAgICAgICAgY29tbXVuaWNhdGlvbl90eXBlLFxuICAgICAgICAgIHN1YmplY3QsXG4gICAgICAgICAgY29tbXVuaWNhdGlvbl9kYXRlLFxuICAgICAgICAgIGNyZWF0ZWRfYnksXG4gICAgICAgICAgY2xpZW50OmNsaWVudHMoXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHBlcnNvbmFsX2RldGFpbHMsXG4gICAgICAgICAgICBjbGllbnRfcmVmXG4gICAgICAgICAgKVxuICAgICAgICBgKVxuICAgICAgICAub3JkZXIoJ2NvbW11bmljYXRpb25fZGF0ZScsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgICAubGltaXQoMzApO1xuXG4gICAgICBpZiAoY29tbXNEYXRhKSB7XG4gICAgICAgIGNvbW1zRGF0YS5mb3JFYWNoKChjb21tOiBhbnkpID0+IHtcbiAgICAgICAgICBhbGxBY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IGBjb21tLSR7Y29tbS5pZH1gLFxuICAgICAgICAgICAgY2xpZW50X2lkOiBjb21tLmNsaWVudF9pZCxcbiAgICAgICAgICAgIGFjdGlvbjogYCR7Y29tbS5jb21tdW5pY2F0aW9uX3R5cGUgfHwgJ0NvbW11bmljYXRpb24nfTogXCIke2NvbW0uc3ViamVjdCB8fCAnTm8gc3ViamVjdCd9XCJgLFxuICAgICAgICAgICAgdHlwZTogJ2NvbW11bmljYXRpb24nLFxuICAgICAgICAgICAgZGF0ZTogY29tbS5jb21tdW5pY2F0aW9uX2RhdGUsXG4gICAgICAgICAgICB1c2VyX25hbWU6IGNvbW0uY3JlYXRlZF9ieSB8fCBudWxsLFxuICAgICAgICAgICAgY2xpZW50TmFtZTogY29tbS5jbGllbnRcbiAgICAgICAgICAgICAgPyBgJHtjb21tLmNsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5maXJzdE5hbWUgfHwgJyd9ICR7Y29tbS5jbGllbnQucGVyc29uYWxfZGV0YWlscz8ubGFzdE5hbWUgfHwgJyd9YC50cmltKClcbiAgICAgICAgICAgICAgOiAnVW5rbm93biBDbGllbnQnLFxuICAgICAgICAgICAgY2xpZW50UmVmOiBjb21tLmNsaWVudD8uY2xpZW50X3JlZiB8fCBudWxsXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgLy8gMy4gRmV0Y2ggcmVjZW50IHJldmlld3NcbiAgICAgIGNvbnN0IHsgZGF0YTogcmV2aWV3c0RhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdyZXZpZXdzJylcbiAgICAgICAgLnNlbGVjdChgXG4gICAgICAgICAgaWQsXG4gICAgICAgICAgY2xpZW50X2lkLFxuICAgICAgICAgIHJldmlld190eXBlLFxuICAgICAgICAgIHN0YXR1cyxcbiAgICAgICAgICBjcmVhdGVkX2F0LFxuICAgICAgICAgIHVwZGF0ZWRfYXQsXG4gICAgICAgICAgY2xpZW50OmNsaWVudHMoXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHBlcnNvbmFsX2RldGFpbHMsXG4gICAgICAgICAgICBjbGllbnRfcmVmXG4gICAgICAgICAgKVxuICAgICAgICBgKVxuICAgICAgICAub3JkZXIoJ3VwZGF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDMwKTtcblxuICAgICAgaWYgKHJldmlld3NEYXRhKSB7XG4gICAgICAgIHJldmlld3NEYXRhLmZvckVhY2goKHJldmlldzogYW55KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdHVzVGV4dCA9IHJldmlldy5zdGF0dXMgPT09ICdjb21wbGV0ZWQnID8gJ2NvbXBsZXRlZCcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2aWV3LnN0YXR1cyA9PT0gJ292ZXJkdWUnID8gJ2lzIG92ZXJkdWUnIDogJ3NjaGVkdWxlZCdcbiAgICAgICAgICBhbGxBY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IGByZXZpZXctJHtyZXZpZXcuaWR9YCxcbiAgICAgICAgICAgIGNsaWVudF9pZDogcmV2aWV3LmNsaWVudF9pZCxcbiAgICAgICAgICAgIGFjdGlvbjogYCR7cmV2aWV3LnJldmlld190eXBlIHx8ICdSZXZpZXcnfSAke3N0YXR1c1RleHR9YCxcbiAgICAgICAgICAgIHR5cGU6ICdyZXZpZXcnLFxuICAgICAgICAgICAgZGF0ZTogcmV2aWV3LnVwZGF0ZWRfYXQgfHwgcmV2aWV3LmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICB1c2VyX25hbWU6IG51bGwsXG4gICAgICAgICAgICBjbGllbnROYW1lOiByZXZpZXcuY2xpZW50XG4gICAgICAgICAgICAgID8gYCR7cmV2aWV3LmNsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5maXJzdE5hbWUgfHwgJyd9ICR7cmV2aWV3LmNsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5sYXN0TmFtZSB8fCAnJ31gLnRyaW0oKVxuICAgICAgICAgICAgICA6ICdVbmtub3duIENsaWVudCcsXG4gICAgICAgICAgICBjbGllbnRSZWY6IHJldmlldy5jbGllbnQ/LmNsaWVudF9yZWYgfHwgbnVsbFxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIDQuIEZldGNoIHJlY2VudGx5IGNyZWF0ZWQvdXBkYXRlZCBjbGllbnRzXG4gICAgICBjb25zdCB7IGRhdGE6IGNsaWVudHNEYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY2xpZW50cycpXG4gICAgICAgIC5zZWxlY3QoJ2lkLCBwZXJzb25hbF9kZXRhaWxzLCBjbGllbnRfcmVmLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0JylcbiAgICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgIC5saW1pdCgyMCk7XG5cbiAgICAgIGlmIChjbGllbnRzRGF0YSkge1xuICAgICAgICBjbGllbnRzRGF0YS5mb3JFYWNoKChjbGllbnQ6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNsaWVudE5hbWUgPSBgJHtjbGllbnQucGVyc29uYWxfZGV0YWlscz8uZmlyc3ROYW1lIHx8ICcnfSAke2NsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5sYXN0TmFtZSB8fCAnJ31gLnRyaW0oKSB8fCAnVW5rbm93biBDbGllbnQnXG4gICAgICAgICAgLy8gT25seSBhZGQgaWYgY3JlYXRlZCByZWNlbnRseSAod2l0aGluIGxhc3QgOTAgZGF5cykgLSBhcyBhIFwiY2xpZW50IGFkZGVkXCIgYWN0aXZpdHlcbiAgICAgICAgICBjb25zdCBjcmVhdGVkRGF0ZSA9IG5ldyBEYXRlKGNsaWVudC5jcmVhdGVkX2F0KVxuICAgICAgICAgIGNvbnN0IG5pbmV0eURheXNBZ28gPSBuZXcgRGF0ZSgpXG4gICAgICAgICAgbmluZXR5RGF5c0Fnby5zZXREYXRlKG5pbmV0eURheXNBZ28uZ2V0RGF0ZSgpIC0gOTApXG5cbiAgICAgICAgICBpZiAoY3JlYXRlZERhdGUgPiBuaW5ldHlEYXlzQWdvKSB7XG4gICAgICAgICAgICBhbGxBY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgICBpZDogYGNsaWVudC1jcmVhdGVkLSR7Y2xpZW50LmlkfWAsXG4gICAgICAgICAgICAgIGNsaWVudF9pZDogY2xpZW50LmlkLFxuICAgICAgICAgICAgICBhY3Rpb246ICdDbGllbnQgYWRkZWQgdG8gc3lzdGVtJyxcbiAgICAgICAgICAgICAgdHlwZTogJ2NsaWVudF9hZGRlZCcsXG4gICAgICAgICAgICAgIGRhdGU6IGNsaWVudC5jcmVhdGVkX2F0LFxuICAgICAgICAgICAgICB1c2VyX25hbWU6IG51bGwsXG4gICAgICAgICAgICAgIGNsaWVudE5hbWUsXG4gICAgICAgICAgICAgIGNsaWVudFJlZjogY2xpZW50LmNsaWVudF9yZWYgfHwgbnVsbFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIDUuIEZldGNoIHJlY2VudCBzdWl0YWJpbGl0eSBhc3Nlc3NtZW50c1xuICAgICAgY29uc3QgeyBkYXRhOiBhc3Nlc3NtZW50c0RhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzdWl0YWJpbGl0eV9hc3Nlc3NtZW50cycpXG4gICAgICAgIC5zZWxlY3QoYFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIGNsaWVudF9pZCxcbiAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgY3JlYXRlZF9hdCxcbiAgICAgICAgICB1cGRhdGVkX2F0LFxuICAgICAgICAgIGNsaWVudDpjbGllbnRzKFxuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICBwZXJzb25hbF9kZXRhaWxzLFxuICAgICAgICAgICAgY2xpZW50X3JlZlxuICAgICAgICAgIClcbiAgICAgICAgYClcbiAgICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgIC5saW1pdCgyMCk7XG5cbiAgICAgIGlmIChhc3Nlc3NtZW50c0RhdGEpIHtcbiAgICAgICAgYXNzZXNzbWVudHNEYXRhLmZvckVhY2goKGFzc2Vzc21lbnQ6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBhc3Nlc3NtZW50LnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgPyAnU3VpdGFiaWxpdHkgYXNzZXNzbWVudCBjb21wbGV0ZWQnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2Vzc21lbnQuc3RhdHVzID09PSAnaW5fcHJvZ3Jlc3MnID8gJ1N1aXRhYmlsaXR5IGFzc2Vzc21lbnQgc3RhcnRlZCcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1N1aXRhYmlsaXR5IGFzc2Vzc21lbnQgY3JlYXRlZCdcbiAgICAgICAgICBhbGxBY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IGBhc3Nlc3NtZW50LSR7YXNzZXNzbWVudC5pZH1gLFxuICAgICAgICAgICAgY2xpZW50X2lkOiBhc3Nlc3NtZW50LmNsaWVudF9pZCxcbiAgICAgICAgICAgIGFjdGlvbjogc3RhdHVzVGV4dCxcbiAgICAgICAgICAgIHR5cGU6ICdhc3Nlc3NtZW50JyxcbiAgICAgICAgICAgIGRhdGU6IGFzc2Vzc21lbnQudXBkYXRlZF9hdCB8fCBhc3Nlc3NtZW50LmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICB1c2VyX25hbWU6IG51bGwsXG4gICAgICAgICAgICBjbGllbnROYW1lOiBhc3Nlc3NtZW50LmNsaWVudFxuICAgICAgICAgICAgICA/IGAke2Fzc2Vzc21lbnQuY2xpZW50LnBlcnNvbmFsX2RldGFpbHM/LmZpcnN0TmFtZSB8fCAnJ30gJHthc3Nlc3NtZW50LmNsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5sYXN0TmFtZSB8fCAnJ31gLnRyaW0oKVxuICAgICAgICAgICAgICA6ICdVbmtub3duIENsaWVudCcsXG4gICAgICAgICAgICBjbGllbnRSZWY6IGFzc2Vzc21lbnQuY2xpZW50Py5jbGllbnRfcmVmIHx8IG51bGxcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICAvLyA2LiBGZXRjaCByZWNlbnQgTW9udGUgQ2FybG8gc2ltdWxhdGlvbnNcbiAgICAgIGNvbnN0IHsgZGF0YTogbW9udGVDYXJsb0RhdGEsIGVycm9yOiBtY0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnbW9udGVfY2FybG9fcmVzdWx0cycpXG4gICAgICAgIC5zZWxlY3QoYFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIGNsaWVudF9pZCxcbiAgICAgICAgICBzY2VuYXJpb19pZCxcbiAgICAgICAgICBzY2VuYXJpb19uYW1lLFxuICAgICAgICAgIGNyZWF0ZWRfYXRcbiAgICAgICAgYClcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgIC5saW1pdCgyMCk7XG5cbiAgICAgIGlmIChtY0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIE1vbnRlIENhcmxvIGRhdGE6JywgbWNFcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb250ZUNhcmxvRGF0YSAmJiBtb250ZUNhcmxvRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IG1vbnRlQ2FybG9Sb3dzID0gbW9udGVDYXJsb0RhdGEgYXMgTW9udGVDYXJsb1Jvd1tdO1xuICAgICAgICAvLyBHZXQgdW5pcXVlIHNjZW5hcmlvIElEcyB0byBmZXRjaCBjbGllbnQgaW5mb1xuICAgICAgICBjb25zdCBzY2VuYXJpb0lkcyA9IFtcbiAgICAgICAgICAuLi5uZXcgU2V0KG1vbnRlQ2FybG9Sb3dzLm1hcCgobWMpID0+IG1jLnNjZW5hcmlvX2lkKS5maWx0ZXIoKGlkKTogaWQgaXMgc3RyaW5nID0+IEJvb2xlYW4oaWQpKSlcbiAgICAgICAgXTtcblxuICAgICAgICAvLyBGZXRjaCBzY2VuYXJpbyAtPiBjbGllbnQgbWFwcGluZ1xuICAgICAgICBjb25zdCB7IGRhdGE6IHNjZW5hcmlvRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgnY2FzaF9mbG93X3NjZW5hcmlvcycpXG4gICAgICAgICAgLnNlbGVjdCgnaWQsIGNsaWVudF9pZCwgc2NlbmFyaW9fbmFtZScpXG4gICAgICAgICAgLmluKCdpZCcsIHNjZW5hcmlvSWRzKTtcblxuICAgICAgICBjb25zdCBzY2VuYXJpb01hcCA9IG5ldyBNYXA8c3RyaW5nLCBDYXNoRmxvd1NjZW5hcmlvUm93PihcbiAgICAgICAgICAoc2NlbmFyaW9EYXRhIHx8IFtdKS5tYXAoKHM6IENhc2hGbG93U2NlbmFyaW9Sb3cpID0+IFtzLmlkLCBzXSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBHZXQgYWxsIGNsaWVudCBJRHMgKGRpcmVjdCArIHZpYSBzY2VuYXJpbylcbiAgICAgICAgY29uc3QgY2xpZW50SWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIG1vbnRlQ2FybG9Sb3dzLmZvckVhY2goKG1jKSA9PiB7XG4gICAgICAgICAgaWYgKG1jLmNsaWVudF9pZCkgY2xpZW50SWRzLmFkZChtYy5jbGllbnRfaWQpO1xuICAgICAgICAgIGNvbnN0IHNjZW5hcmlvID0gbWMuc2NlbmFyaW9faWQgPyBzY2VuYXJpb01hcC5nZXQobWMuc2NlbmFyaW9faWQpIDogdW5kZWZpbmVkO1xuICAgICAgICAgIGlmIChzY2VuYXJpbz8uY2xpZW50X2lkKSBjbGllbnRJZHMuYWRkKHNjZW5hcmlvLmNsaWVudF9pZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZldGNoIGNsaWVudCBuYW1lcyAob25seSBpZiB3ZSBoYXZlIGNsaWVudCBJRHMpXG4gICAgICAgIGxldCBjbGllbnRNYXAgPSBuZXcgTWFwPHN0cmluZywgQ2xpZW50Um93PigpO1xuICAgICAgICBpZiAoY2xpZW50SWRzLnNpemUgPiAwKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBjbGllbnRzRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdjbGllbnRzJylcbiAgICAgICAgICAgIC5zZWxlY3QoJ2lkLCBwZXJzb25hbF9kZXRhaWxzLCBjbGllbnRfcmVmJylcbiAgICAgICAgICAgIC5pbignaWQnLCBBcnJheS5mcm9tKGNsaWVudElkcykpO1xuICAgICAgICAgIGNsaWVudE1hcCA9IG5ldyBNYXAoXG4gICAgICAgICAgICAoY2xpZW50c0RhdGEgfHwgW10pLm1hcCgoYzogQ2xpZW50Um93KSA9PiBbYy5pZCwgY10pXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vbnRlQ2FybG9Sb3dzLmZvckVhY2goKG1jKSA9PiB7XG4gICAgICAgICAgLy8gVHJ5IGRpcmVjdCBjbGllbnRfaWQgZmlyc3QsIHRoZW4gZmFsbCBiYWNrIHRvIHNjZW5hcmlvJ3MgY2xpZW50X2lkXG4gICAgICAgICAgY29uc3Qgc2NlbmFyaW8gPSBtYy5zY2VuYXJpb19pZCA/IHNjZW5hcmlvTWFwLmdldChtYy5zY2VuYXJpb19pZCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgY29uc3QgY2xpZW50SWQgPSBtYy5jbGllbnRfaWQgfHwgc2NlbmFyaW8/LmNsaWVudF9pZCB8fCBudWxsO1xuICAgICAgICAgIGNvbnN0IGNsaWVudCA9IGNsaWVudElkID8gY2xpZW50TWFwLmdldChjbGllbnRJZCkgOiBudWxsO1xuXG4gICAgICAgICAgLy8gSW5jbHVkZSBBTEwgTW9udGUgQ2FybG8gYWN0aXZpdGllc1xuICAgICAgICAgIC8vIElmIGNsaWVudCBpcyByZXNvbHZlZCwgc2hvdyBjbGllbnQgbmFtZTsgb3RoZXJ3aXNlIHNob3cgYXMgXCJQcm9qZWN0aW9uIEFuYWx5c2lzXCJcbiAgICAgICAgICBpZiAoY2xpZW50KSB7XG4gICAgICAgICAgICBjb25zdCBmaXJzdE5hbWUgPSBjbGllbnQucGVyc29uYWxfZGV0YWlscz8uZmlyc3ROYW1lIHx8IGNsaWVudC5wZXJzb25hbF9kZXRhaWxzPy5maXJzdF9uYW1lIHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgbGFzdE5hbWUgPSBjbGllbnQucGVyc29uYWxfZGV0YWlscz8ubGFzdE5hbWUgfHwgY2xpZW50LnBlcnNvbmFsX2RldGFpbHM/Lmxhc3RfbmFtZSB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IGNsaWVudE5hbWUgPSBgJHtmaXJzdE5hbWV9ICR7bGFzdE5hbWV9YC50cmltKCk7XG4gICAgICAgICAgICBhbGxBY3Rpdml0aWVzLnB1c2goe1xuICAgICAgICAgICAgICBpZDogYG1jLSR7bWMuaWR9YCxcbiAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRJZCxcbiAgICAgICAgICAgICAgYWN0aW9uOiBgTW9udGUgQ2FybG8gc2ltdWxhdGlvbjogJHttYy5zY2VuYXJpb19uYW1lIHx8IHNjZW5hcmlvPy5zY2VuYXJpb19uYW1lIHx8ICdBbmFseXNpcyBjb21wbGV0ZWQnfWAsXG4gICAgICAgICAgICAgIHR5cGU6ICdtb250ZV9jYXJsbycsXG4gICAgICAgICAgICAgIGRhdGU6IG1jLmNyZWF0ZWRfYXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICB1c2VyX25hbWU6IG51bGwsXG4gICAgICAgICAgICAgIGNsaWVudE5hbWU6IGNsaWVudE5hbWUgfHwgJ1Byb2plY3Rpb24gQW5hbHlzaXMnLFxuICAgICAgICAgICAgICBjbGllbnRSZWY6IGNsaWVudD8uY2xpZW50X3JlZiA/PyBudWxsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBObyBjbGllbnQgbGlua2VkIC0gc2hvdyBhcyBzeXN0ZW0tbGV2ZWwgYWN0aXZpdHlcbiAgICAgICAgICAgIGFsbEFjdGl2aXRpZXMucHVzaCh7XG4gICAgICAgICAgICAgIGlkOiBgbWMtJHttYy5pZH1gLFxuICAgICAgICAgICAgICBjbGllbnRfaWQ6IG51bGwsXG4gICAgICAgICAgICAgIGFjdGlvbjogYE1vbnRlIENhcmxvIHNpbXVsYXRpb246ICR7bWMuc2NlbmFyaW9fbmFtZSB8fCBzY2VuYXJpbz8uc2NlbmFyaW9fbmFtZSB8fCAnQW5hbHlzaXMgY29tcGxldGVkJ31gLFxuICAgICAgICAgICAgICB0eXBlOiAnbW9udGVfY2FybG8nLFxuICAgICAgICAgICAgICBkYXRlOiBtYy5jcmVhdGVkX2F0IHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgdXNlcl9uYW1lOiBudWxsLFxuICAgICAgICAgICAgICBjbGllbnROYW1lOiAnUHJvamVjdGlvbiBBbmFseXNpcycsXG4gICAgICAgICAgICAgIGNsaWVudFJlZjogbnVsbFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIFNvcnQgYWxsIGFjdGl2aXRpZXMgYnkgZGF0ZSBkZXNjZW5kaW5nIGFuZCBkZWR1cGxpY2F0ZVxuICAgICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpXG4gICAgICBjb25zdCBzb3J0ZWRBY3Rpdml0aWVzID0gYWxsQWN0aXZpdGllc1xuICAgICAgICAuZmlsdGVyKGEgPT4ge1xuICAgICAgICAgIC8vIERlZHVwbGljYXRlIGJ5IGFjdGlvbiArIGNsaWVudCArIGRhdGUgKHJvdW5kZWQgdG8gbWludXRlKVxuICAgICAgICAgIGNvbnN0IGtleSA9IGAke2EuYWN0aW9ufS0ke2EuY2xpZW50X2lkfS0ke2EuZGF0ZT8uc2xpY2UoMCwgMTYpfWBcbiAgICAgICAgICBpZiAoc2Vlbi5oYXMoa2V5KSkgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgc2Vlbi5hZGQoa2V5KVxuICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEuZGF0ZSkuZ2V0VGltZSgpKVxuICAgICAgICAuc2xpY2UoMCwgbGltaXQpXG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIGRhdGE6IHNvcnRlZEFjdGl2aXRpZXNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFJlZ3VsYXIgY2xpZW50LXNwZWNpZmljIGFjdGl2aXR5IGxvZ1xuICAgIGlmICghY2xpZW50SWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0NsaWVudCBJRCBpcyByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FjdGl2aXR5X2xvZycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KVxuICAgICAgLmVxKCdjbGllbnRfaWQnLCBjbGllbnRJZClcbiAgICAgIC5vcmRlcignZGF0ZScsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgLnJhbmdlKG9mZnNldCwgb2Zmc2V0ICsgbGltaXQgLSAxKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdFcnJvciBmZXRjaGluZyBhY3Rpdml0eSBsb2cnLCBlcnJvciwgeyBjbGllbnRJZCB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBhY3Rpdml0eSBsb2cnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIGRhdGE6IGRhdGEgfHwgW10sXG4gICAgICB0b3RhbDogY291bnQgfHwgMCxcbiAgICAgIGxpbWl0LFxuICAgICAgb2Zmc2V0XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKCdFcnJvciBpbiBHRVQgL2FwaS9hY3Rpdml0eS1sb2cnLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLy8gUE9TVCAtIENyZWF0ZSBuZXcgYWN0aXZpdHkgbG9nIGVudHJ5XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IFxuICAgICAgY2xpZW50SWQsIFxuICAgICAgYWN0aW9uLCBcbiAgICAgIHR5cGUsXG4gICAgICB1c2VyTmFtZVxuICAgIH0gPSBib2R5O1xuXG4gICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFjbGllbnRJZCB8fCAhYWN0aW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7ICAvLyBGSVhFRDogVXNpbmcgYXdhaXQsIG5vIHBhcmFtZXRlcnNcblxuICAgIC8vIENyZWF0ZSB0aGUgYWN0aXZpdHkgbG9nIGVudHJ5IG1hdGNoaW5nIHlvdXIgdGFibGUgc3RydWN0dXJlXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY3Rpdml0eV9sb2cnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIGNsaWVudF9pZDogY2xpZW50SWQsXG4gICAgICAgIGFjdGlvbixcbiAgICAgICAgdHlwZTogdHlwZSB8fCBudWxsLFxuICAgICAgICB1c2VyX25hbWU6IHVzZXJOYW1lIHx8IG51bGwsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGFjdGl2aXR5IGxvZycsIGVycm9yKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgYWN0aXZpdHkgbG9nJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcbiAgICAgIGRhdGEgXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKCdFcnJvciBpbiBQT1NUIC9hcGkvYWN0aXZpdHktbG9nJywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiZHluYW1pYyIsIk5leHRSZXNwb25zZSIsImNyZWF0ZUNsaWVudCIsImxvZyIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJjbGllbnRJZCIsImdldCIsInJlY2VudCIsImxpbWl0IiwicGFyc2VJbnQiLCJvZmZzZXQiLCJzdXBhYmFzZSIsImFsbEFjdGl2aXRpZXMiLCJkYXRhIiwiYWN0aXZpdHlMb2dEYXRhIiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZm9yRWFjaCIsImFjdGl2aXR5IiwicHVzaCIsImlkIiwiY2xpZW50X2lkIiwiYWN0aW9uIiwidHlwZSIsImRhdGUiLCJ1c2VyX25hbWUiLCJjbGllbnROYW1lIiwiY2xpZW50IiwicGVyc29uYWxfZGV0YWlscyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidHJpbSIsImNsaWVudFJlZiIsImNsaWVudF9yZWYiLCJjb21tc0RhdGEiLCJjb21tIiwiY29tbXVuaWNhdGlvbl90eXBlIiwic3ViamVjdCIsImNvbW11bmljYXRpb25fZGF0ZSIsImNyZWF0ZWRfYnkiLCJyZXZpZXdzRGF0YSIsInJldmlldyIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJyZXZpZXdfdHlwZSIsInVwZGF0ZWRfYXQiLCJjcmVhdGVkX2F0IiwiY2xpZW50c0RhdGEiLCJjcmVhdGVkRGF0ZSIsIkRhdGUiLCJuaW5ldHlEYXlzQWdvIiwic2V0RGF0ZSIsImdldERhdGUiLCJhc3Nlc3NtZW50c0RhdGEiLCJhc3Nlc3NtZW50IiwibW9udGVDYXJsb0RhdGEiLCJlcnJvciIsIm1jRXJyb3IiLCJjb25zb2xlIiwibGVuZ3RoIiwibW9udGVDYXJsb1Jvd3MiLCJzY2VuYXJpb0lkcyIsIlNldCIsIm1hcCIsIm1jIiwic2NlbmFyaW9faWQiLCJmaWx0ZXIiLCJCb29sZWFuIiwic2NlbmFyaW9EYXRhIiwiaW4iLCJzY2VuYXJpb01hcCIsIk1hcCIsInMiLCJjbGllbnRJZHMiLCJhZGQiLCJzY2VuYXJpbyIsInVuZGVmaW5lZCIsImNsaWVudE1hcCIsInNpemUiLCJBcnJheSIsImMiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwic2NlbmFyaW9fbmFtZSIsInRvSVNPU3RyaW5nIiwic2VlbiIsInNvcnRlZEFjdGl2aXRpZXMiLCJhIiwia2V5Iiwic2xpY2UiLCJoYXMiLCJzb3J0IiwiYiIsImdldFRpbWUiLCJqc29uIiwiY291bnQiLCJlcSIsInJhbmdlIiwidG90YWwiLCJQT1NUIiwiYm9keSIsInVzZXJOYW1lIiwiaW5zZXJ0Iiwic2luZ2xlIiwic3VjY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/activity-log/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/errors/index.ts":
/*!*********************************!*\
  !*** ./src/lib/errors/index.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppError: () => (/* binding */ AppError),\n/* harmony export */   AssessmentError: () => (/* binding */ AssessmentError),\n/* harmony export */   CalculationError: () => (/* binding */ CalculationError),\n/* harmony export */   DatabaseError: () => (/* binding */ DatabaseError),\n/* harmony export */   ERROR_STATUS_CODES: () => (/* binding */ ERROR_STATUS_CODES),\n/* harmony export */   ErrorCode: () => (/* binding */ ErrorCode),\n/* harmony export */   ForbiddenError: () => (/* binding */ ForbiddenError),\n/* harmony export */   InvalidStateTransitionError: () => (/* binding */ InvalidStateTransitionError),\n/* harmony export */   NotFoundError: () => (/* binding */ NotFoundError),\n/* harmony export */   RateLimitError: () => (/* binding */ RateLimitError),\n/* harmony export */   UnauthorizedError: () => (/* binding */ UnauthorizedError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   formatErrorResponse: () => (/* binding */ formatErrorResponse),\n/* harmony export */   getErrorDetails: () => (/* binding */ getErrorDetails),\n/* harmony export */   getErrorMessage: () => (/* binding */ getErrorMessage),\n/* harmony export */   isAppError: () => (/* binding */ isAppError),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   toAppError: () => (/* binding */ toAppError)\n/* harmony export */ });\n// =====================================================\n// FILE: src/lib/errors/index.ts\n// PURPOSE: Centralized error types for consistent error handling\n// Phase 3: Architecture & Error Handling\n// =====================================================\n/**\n * Error codes used throughout the application\n * These map to HTTP status codes and provide semantic meaning\n */ var ErrorCode;\n(function(ErrorCode) {\n    // Client errors (4xx)\n    ErrorCode[\"VALIDATION_ERROR\"] = \"VALIDATION_ERROR\";\n    ErrorCode[\"NOT_FOUND\"] = \"NOT_FOUND\";\n    ErrorCode[\"UNAUTHORIZED\"] = \"UNAUTHORIZED\";\n    ErrorCode[\"FORBIDDEN\"] = \"FORBIDDEN\";\n    ErrorCode[\"CONFLICT\"] = \"CONFLICT\";\n    ErrorCode[\"RATE_LIMITED\"] = \"RATE_LIMITED\";\n    // Business logic errors\n    ErrorCode[\"CALCULATION_ERROR\"] = \"CALCULATION_ERROR\";\n    ErrorCode[\"ASSESSMENT_ERROR\"] = \"ASSESSMENT_ERROR\";\n    ErrorCode[\"INVALID_STATE_TRANSITION\"] = \"INVALID_STATE_TRANSITION\";\n    // Server errors (5xx)\n    ErrorCode[\"DATABASE_ERROR\"] = \"DATABASE_ERROR\";\n    ErrorCode[\"EXTERNAL_SERVICE_ERROR\"] = \"EXTERNAL_SERVICE_ERROR\";\n    ErrorCode[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n})(ErrorCode || (ErrorCode = {}));\n/**\n * Maps error codes to HTTP status codes\n */ const ERROR_STATUS_CODES = {\n    [\"VALIDATION_ERROR\"]: 400,\n    [\"NOT_FOUND\"]: 404,\n    [\"UNAUTHORIZED\"]: 401,\n    [\"FORBIDDEN\"]: 403,\n    [\"CONFLICT\"]: 409,\n    [\"RATE_LIMITED\"]: 429,\n    [\"CALCULATION_ERROR\"]: 422,\n    [\"ASSESSMENT_ERROR\"]: 422,\n    [\"INVALID_STATE_TRANSITION\"]: 422,\n    [\"DATABASE_ERROR\"]: 500,\n    [\"EXTERNAL_SERVICE_ERROR\"]: 502,\n    [\"INTERNAL_ERROR\"]: 500\n};\n/**\n * Base application error class\n * All custom errors should extend this class\n */ class AppError extends Error {\n    constructor(code, message, details){\n        super(message);\n        this.name = \"AppError\";\n        this.code = code;\n        this.statusCode = ERROR_STATUS_CODES[code];\n        this.details = details;\n        this.timestamp = new Date().toISOString();\n        // Maintains proper stack trace for where error was thrown\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        }\n    }\n    /**\n   * Convert error to JSON for API responses\n   */ toJSON() {\n        return {\n            error: {\n                code: this.code,\n                message: this.message,\n                details: this.details,\n                timestamp: this.timestamp\n            }\n        };\n    }\n}\n/**\n * Validation error - input data failed validation\n */ class ValidationError extends AppError {\n    constructor(message, details){\n        super(\"VALIDATION_ERROR\", message, details);\n        this.name = \"ValidationError\";\n    }\n}\n/**\n * Not found error - requested resource doesn't exist\n */ class NotFoundError extends AppError {\n    constructor(resource, identifier){\n        const message = identifier ? `${resource} with ID '${identifier}' not found` : `${resource} not found`;\n        super(\"NOT_FOUND\", message, {\n            resource,\n            identifier\n        });\n        this.name = \"NotFoundError\";\n    }\n}\n/**\n * Unauthorized error - authentication required\n */ class UnauthorizedError extends AppError {\n    constructor(message = \"Authentication required\"){\n        super(\"UNAUTHORIZED\", message);\n        this.name = \"UnauthorizedError\";\n    }\n}\n/**\n * Forbidden error - insufficient permissions\n */ class ForbiddenError extends AppError {\n    constructor(message = \"You do not have permission to perform this action\"){\n        super(\"FORBIDDEN\", message);\n        this.name = \"ForbiddenError\";\n    }\n}\n/**\n * Calculation error - mathematical or business logic calculation failed\n */ class CalculationError extends AppError {\n    constructor(message, details){\n        super(\"CALCULATION_ERROR\", message, details);\n        this.name = \"CalculationError\";\n    }\n}\n/**\n * Assessment error - assessment-specific business logic error\n */ class AssessmentError extends AppError {\n    constructor(message, details){\n        super(\"ASSESSMENT_ERROR\", message, details);\n        this.name = \"AssessmentError\";\n    }\n}\n/**\n * Invalid state transition error - workflow state transition not allowed\n */ class InvalidStateTransitionError extends AppError {\n    constructor(from, to, resource = \"Assessment\"){\n        super(\"INVALID_STATE_TRANSITION\", `Cannot transition ${resource} from '${from}' to '${to}'`, {\n            from,\n            to,\n            resource\n        });\n        this.name = \"InvalidStateTransitionError\";\n    }\n}\n/**\n * Database error - database operation failed\n */ class DatabaseError extends AppError {\n    constructor(message, details){\n        super(\"DATABASE_ERROR\", message, details);\n        this.name = \"DatabaseError\";\n    }\n}\n/**\n * Rate limit error - too many requests\n */ class RateLimitError extends AppError {\n    constructor(retryAfter = 60){\n        super(\"RATE_LIMITED\", \"Too many requests. Please try again later.\", {\n            retryAfter\n        });\n        this.name = \"RateLimitError\";\n        this.retryAfter = retryAfter;\n    }\n}\n// =====================================================\n// ERROR HANDLING UTILITIES\n// =====================================================\n/**\n * Type guard to check if an error is an AppError\n */ function isAppError(error) {\n    return error instanceof AppError;\n}\n/**\n * Safely extract error message from unknown error\n */ function getErrorMessage(error) {\n    if (error instanceof Error) {\n        return error.message;\n    }\n    if (typeof error === \"string\") {\n        return error;\n    }\n    return \"An unknown error occurred\";\n}\n/**\n * Safely extract error details for logging\n */ function getErrorDetails(error) {\n    if (isAppError(error)) {\n        return {\n            code: error.code,\n            message: error.message,\n            details: error.details,\n            stack: error.stack\n        };\n    }\n    if (error instanceof Error) {\n        // Check for Supabase PostgrestError which extends Error but has extra fields\n        const supabaseError = error;\n        if (\"code\" in error && \"details\" in error) {\n            return {\n                name: error.name,\n                message: error.message,\n                code: supabaseError.code,\n                details: supabaseError.details,\n                hint: supabaseError.hint,\n                stack: error.stack\n            };\n        }\n        return {\n            name: error.name,\n            message: error.message,\n            stack: error.stack\n        };\n    }\n    // Handle plain objects (like Supabase error responses that aren't Error instances)\n    if (typeof error === \"object\" && error !== null) {\n        const obj = error;\n        // Check for Supabase-style error objects\n        if (\"code\" in obj || \"message\" in obj) {\n            return {\n                code: obj.code,\n                message: obj.message,\n                details: obj.details,\n                hint: obj.hint\n            };\n        }\n        // Return the object as-is for other plain objects\n        try {\n            // Attempt to serialize - if it fails, fall back to String\n            JSON.stringify(obj);\n            return obj;\n        } catch  {\n            return {\n                error: String(error)\n            };\n        }\n    }\n    return {\n        error: String(error)\n    };\n}\n/**\n * Convert any error to an AppError for consistent API responses\n */ function toAppError(error) {\n    if (isAppError(error)) {\n        return error;\n    }\n    const message = getErrorMessage(error);\n    // Check for common error patterns\n    if (error instanceof Error) {\n        // Supabase/PostgreSQL errors\n        if (\"code\" in error && typeof error.code === \"string\") {\n            const pgCode = error.code;\n            if (pgCode === \"23505\") {\n                return new AppError(\"CONFLICT\", \"Resource already exists\", {\n                    pgCode\n                });\n            }\n            if (pgCode === \"23503\") {\n                return new AppError(\"VALIDATION_ERROR\", \"Referenced resource not found\", {\n                    pgCode\n                });\n            }\n            if (pgCode.startsWith(\"42\")) {\n                return new DatabaseError(\"Database schema error\", {\n                    pgCode\n                });\n            }\n        }\n    }\n    return new AppError(\"INTERNAL_ERROR\", message);\n}\n/**\n * Format error for NextResponse JSON\n */ function formatErrorResponse(error) {\n    const appError = toAppError(error);\n    return {\n        body: appError.toJSON(),\n        status: appError.statusCode\n    };\n}\n/**\n * Simple structured logger\n * In production, this should be replaced with a proper logging service\n */ const logger = {\n    debug (message, context) {\n        if (true) {\n            console.debug(JSON.stringify({\n                level: \"debug\",\n                message,\n                context,\n                timestamp: new Date().toISOString()\n            }));\n        }\n    },\n    info (message, context) {\n        console.info(JSON.stringify({\n            level: \"info\",\n            message,\n            context,\n            timestamp: new Date().toISOString()\n        }));\n    },\n    warn (message, context) {\n        console.warn(JSON.stringify({\n            level: \"warn\",\n            message,\n            context,\n            timestamp: new Date().toISOString()\n        }));\n    },\n    error (message, error, context) {\n        const errorDetails = error ? getErrorDetails(error) : undefined;\n        console.error(JSON.stringify({\n            level: \"error\",\n            message,\n            error: errorDetails,\n            context,\n            timestamp: new Date().toISOString()\n        }));\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckRFLFFBQVFFLElBQUksQ0FBQ2hCLEtBQUtDLFNBQVMsQ0FBQztZQUFFYyxPQUFPO1lBQVE5QztZQUFTMkM7WUFBU3ZDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztRQUFHO0lBQ3JHO0lBRUEwQyxNQUFLaEQsT0FBZSxFQUFFMkMsT0FBaUM7UUFDckRFLFFBQVFHLElBQUksQ0FBQ2pCLEtBQUtDLFNBQVMsQ0FBQztZQUFFYyxPQUFPO1lBQVE5QztZQUFTMkM7WUFBU3ZDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztRQUFHO0lBQ3JHO0lBRUFHLE9BQU1ULE9BQWUsRUFBRVMsS0FBZSxFQUFFa0MsT0FBaUM7UUFDdkUsTUFBTU0sZUFBZXhDLFFBQVFpQixnQkFBZ0JqQixTQUFTeUM7UUFDdERMLFFBQVFwQyxLQUFLLENBQUNzQixLQUFLQyxTQUFTLENBQUM7WUFDM0JjLE9BQU87WUFDUDlDO1lBQ0FTLE9BQU93QztZQUNQTjtZQUNBdkMsV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1FBQ25DO0lBQ0Y7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGxhbm5ldGljLXBsYXRmb3JtLy4vc3JjL2xpYi9lcnJvcnMvaW5kZXgudHM/OTM4NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRklMRTogc3JjL2xpYi9lcnJvcnMvaW5kZXgudHNcbi8vIFBVUlBPU0U6IENlbnRyYWxpemVkIGVycm9yIHR5cGVzIGZvciBjb25zaXN0ZW50IGVycm9yIGhhbmRsaW5nXG4vLyBQaGFzZSAzOiBBcmNoaXRlY3R1cmUgJiBFcnJvciBIYW5kbGluZ1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBFcnJvciBjb2RlcyB1c2VkIHRocm91Z2hvdXQgdGhlIGFwcGxpY2F0aW9uXG4gKiBUaGVzZSBtYXAgdG8gSFRUUCBzdGF0dXMgY29kZXMgYW5kIHByb3ZpZGUgc2VtYW50aWMgbWVhbmluZ1xuICovXG5leHBvcnQgZW51bSBFcnJvckNvZGUge1xuICAvLyBDbGllbnQgZXJyb3JzICg0eHgpXG4gIFZBTElEQVRJT05fRVJST1IgPSAnVkFMSURBVElPTl9FUlJPUicsXG4gIE5PVF9GT1VORCA9ICdOT1RfRk9VTkQnLFxuICBVTkFVVEhPUklaRUQgPSAnVU5BVVRIT1JJWkVEJyxcbiAgRk9SQklEREVOID0gJ0ZPUkJJRERFTicsXG4gIENPTkZMSUNUID0gJ0NPTkZMSUNUJyxcbiAgUkFURV9MSU1JVEVEID0gJ1JBVEVfTElNSVRFRCcsXG5cbiAgLy8gQnVzaW5lc3MgbG9naWMgZXJyb3JzXG4gIENBTENVTEFUSU9OX0VSUk9SID0gJ0NBTENVTEFUSU9OX0VSUk9SJyxcbiAgQVNTRVNTTUVOVF9FUlJPUiA9ICdBU1NFU1NNRU5UX0VSUk9SJyxcbiAgSU5WQUxJRF9TVEFURV9UUkFOU0lUSU9OID0gJ0lOVkFMSURfU1RBVEVfVFJBTlNJVElPTicsXG5cbiAgLy8gU2VydmVyIGVycm9ycyAoNXh4KVxuICBEQVRBQkFTRV9FUlJPUiA9ICdEQVRBQkFTRV9FUlJPUicsXG4gIEVYVEVSTkFMX1NFUlZJQ0VfRVJST1IgPSAnRVhURVJOQUxfU0VSVklDRV9FUlJPUicsXG4gIElOVEVSTkFMX0VSUk9SID0gJ0lOVEVSTkFMX0VSUk9SJyxcbn1cblxuLyoqXG4gKiBNYXBzIGVycm9yIGNvZGVzIHRvIEhUVFAgc3RhdHVzIGNvZGVzXG4gKi9cbmV4cG9ydCBjb25zdCBFUlJPUl9TVEFUVVNfQ09ERVM6IFJlY29yZDxFcnJvckNvZGUsIG51bWJlcj4gPSB7XG4gIFtFcnJvckNvZGUuVkFMSURBVElPTl9FUlJPUl06IDQwMCxcbiAgW0Vycm9yQ29kZS5OT1RfRk9VTkRdOiA0MDQsXG4gIFtFcnJvckNvZGUuVU5BVVRIT1JJWkVEXTogNDAxLFxuICBbRXJyb3JDb2RlLkZPUkJJRERFTl06IDQwMyxcbiAgW0Vycm9yQ29kZS5DT05GTElDVF06IDQwOSxcbiAgW0Vycm9yQ29kZS5SQVRFX0xJTUlURURdOiA0MjksXG4gIFtFcnJvckNvZGUuQ0FMQ1VMQVRJT05fRVJST1JdOiA0MjIsXG4gIFtFcnJvckNvZGUuQVNTRVNTTUVOVF9FUlJPUl06IDQyMixcbiAgW0Vycm9yQ29kZS5JTlZBTElEX1NUQVRFX1RSQU5TSVRJT05dOiA0MjIsXG4gIFtFcnJvckNvZGUuREFUQUJBU0VfRVJST1JdOiA1MDAsXG4gIFtFcnJvckNvZGUuRVhURVJOQUxfU0VSVklDRV9FUlJPUl06IDUwMixcbiAgW0Vycm9yQ29kZS5JTlRFUk5BTF9FUlJPUl06IDUwMCxcbn1cblxuLyoqXG4gKiBCYXNlIGFwcGxpY2F0aW9uIGVycm9yIGNsYXNzXG4gKiBBbGwgY3VzdG9tIGVycm9ycyBzaG91bGQgZXh0ZW5kIHRoaXMgY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIEFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBwdWJsaWMgcmVhZG9ubHkgY29kZTogRXJyb3JDb2RlXG4gIHB1YmxpYyByZWFkb25seSBzdGF0dXNDb2RlOiBudW1iZXJcbiAgcHVibGljIHJlYWRvbmx5IGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICBwdWJsaWMgcmVhZG9ubHkgdGltZXN0YW1wOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvcihcbiAgICBjb2RlOiBFcnJvckNvZGUsXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdBcHBFcnJvcidcbiAgICB0aGlzLmNvZGUgPSBjb2RlXG4gICAgdGhpcy5zdGF0dXNDb2RlID0gRVJST1JfU1RBVFVTX0NPREVTW2NvZGVdXG4gICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsc1xuICAgIHRoaXMudGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG5cbiAgICAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBlcnJvciB3YXMgdGhyb3duXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGVycm9yIHRvIEpTT04gZm9yIEFQSSByZXNwb25zZXNcbiAgICovXG4gIHRvSlNPTigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogdGhpcy5jb2RlLFxuICAgICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2UsXG4gICAgICAgIGRldGFpbHM6IHRoaXMuZGV0YWlscyxcbiAgICAgICAgdGltZXN0YW1wOiB0aGlzLnRpbWVzdGFtcCxcbiAgICAgIH0sXG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGlvbiBlcnJvciAtIGlucHV0IGRhdGEgZmFpbGVkIHZhbGlkYXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFZhbGlkYXRpb25FcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBzdXBlcihFcnJvckNvZGUuVkFMSURBVElPTl9FUlJPUiwgbWVzc2FnZSwgZGV0YWlscylcbiAgICB0aGlzLm5hbWUgPSAnVmFsaWRhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogTm90IGZvdW5kIGVycm9yIC0gcmVxdWVzdGVkIHJlc291cmNlIGRvZXNuJ3QgZXhpc3RcbiAqL1xuZXhwb3J0IGNsYXNzIE5vdEZvdW5kRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHJlc291cmNlOiBzdHJpbmcsIGlkZW50aWZpZXI/OiBzdHJpbmcpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gaWRlbnRpZmllclxuICAgICAgPyBgJHtyZXNvdXJjZX0gd2l0aCBJRCAnJHtpZGVudGlmaWVyfScgbm90IGZvdW5kYFxuICAgICAgOiBgJHtyZXNvdXJjZX0gbm90IGZvdW5kYFxuICAgIHN1cGVyKEVycm9yQ29kZS5OT1RfRk9VTkQsIG1lc3NhZ2UsIHsgcmVzb3VyY2UsIGlkZW50aWZpZXIgfSlcbiAgICB0aGlzLm5hbWUgPSAnTm90Rm91bmRFcnJvcidcbiAgfVxufVxuXG4vKipcbiAqIFVuYXV0aG9yaXplZCBlcnJvciAtIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXG4gKi9cbmV4cG9ydCBjbGFzcyBVbmF1dGhvcml6ZWRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcpIHtcbiAgICBzdXBlcihFcnJvckNvZGUuVU5BVVRIT1JJWkVELCBtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdVbmF1dGhvcml6ZWRFcnJvcidcbiAgfVxufVxuXG4vKipcbiAqIEZvcmJpZGRlbiBlcnJvciAtIGluc3VmZmljaWVudCBwZXJtaXNzaW9uc1xuICovXG5leHBvcnQgY2xhc3MgRm9yYmlkZGVuRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAnWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gcGVyZm9ybSB0aGlzIGFjdGlvbicpIHtcbiAgICBzdXBlcihFcnJvckNvZGUuRk9SQklEREVOLCBtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdGb3JiaWRkZW5FcnJvcidcbiAgfVxufVxuXG4vKipcbiAqIENhbGN1bGF0aW9uIGVycm9yIC0gbWF0aGVtYXRpY2FsIG9yIGJ1c2luZXNzIGxvZ2ljIGNhbGN1bGF0aW9uIGZhaWxlZFxuICovXG5leHBvcnQgY2xhc3MgQ2FsY3VsYXRpb25FcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBzdXBlcihFcnJvckNvZGUuQ0FMQ1VMQVRJT05fRVJST1IsIG1lc3NhZ2UsIGRldGFpbHMpXG4gICAgdGhpcy5uYW1lID0gJ0NhbGN1bGF0aW9uRXJyb3InXG4gIH1cbn1cblxuLyoqXG4gKiBBc3Nlc3NtZW50IGVycm9yIC0gYXNzZXNzbWVudC1zcGVjaWZpYyBidXNpbmVzcyBsb2dpYyBlcnJvclxuICovXG5leHBvcnQgY2xhc3MgQXNzZXNzbWVudEVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIHN1cGVyKEVycm9yQ29kZS5BU1NFU1NNRU5UX0VSUk9SLCBtZXNzYWdlLCBkZXRhaWxzKVxuICAgIHRoaXMubmFtZSA9ICdBc3Nlc3NtZW50RXJyb3InXG4gIH1cbn1cblxuLyoqXG4gKiBJbnZhbGlkIHN0YXRlIHRyYW5zaXRpb24gZXJyb3IgLSB3b3JrZmxvdyBzdGF0ZSB0cmFuc2l0aW9uIG5vdCBhbGxvd2VkXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnZhbGlkU3RhdGVUcmFuc2l0aW9uRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKGZyb206IHN0cmluZywgdG86IHN0cmluZywgcmVzb3VyY2UgPSAnQXNzZXNzbWVudCcpIHtcbiAgICBzdXBlcihcbiAgICAgIEVycm9yQ29kZS5JTlZBTElEX1NUQVRFX1RSQU5TSVRJT04sXG4gICAgICBgQ2Fubm90IHRyYW5zaXRpb24gJHtyZXNvdXJjZX0gZnJvbSAnJHtmcm9tfScgdG8gJyR7dG99J2AsXG4gICAgICB7IGZyb20sIHRvLCByZXNvdXJjZSB9XG4gICAgKVxuICAgIHRoaXMubmFtZSA9ICdJbnZhbGlkU3RhdGVUcmFuc2l0aW9uRXJyb3InXG4gIH1cbn1cblxuLyoqXG4gKiBEYXRhYmFzZSBlcnJvciAtIGRhdGFiYXNlIG9wZXJhdGlvbiBmYWlsZWRcbiAqL1xuZXhwb3J0IGNsYXNzIERhdGFiYXNlRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgKSB7XG4gICAgc3VwZXIoRXJyb3JDb2RlLkRBVEFCQVNFX0VSUk9SLCBtZXNzYWdlLCBkZXRhaWxzKVxuICAgIHRoaXMubmFtZSA9ICdEYXRhYmFzZUVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogUmF0ZSBsaW1pdCBlcnJvciAtIHRvbyBtYW55IHJlcXVlc3RzXG4gKi9cbmV4cG9ydCBjbGFzcyBSYXRlTGltaXRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgcHVibGljIHJlYWRvbmx5IHJldHJ5QWZ0ZXI6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yKHJldHJ5QWZ0ZXIgPSA2MCkge1xuICAgIHN1cGVyKEVycm9yQ29kZS5SQVRFX0xJTUlURUQsICdUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nLCB7XG4gICAgICByZXRyeUFmdGVyLFxuICAgIH0pXG4gICAgdGhpcy5uYW1lID0gJ1JhdGVMaW1pdEVycm9yJ1xuICAgIHRoaXMucmV0cnlBZnRlciA9IHJldHJ5QWZ0ZXJcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVJST1IgSEFORExJTkcgVVRJTElUSUVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFR5cGUgZ3VhcmQgdG8gY2hlY2sgaWYgYW4gZXJyb3IgaXMgYW4gQXBwRXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQXBwRXJyb3IoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBBcHBFcnJvciB7XG4gIHJldHVybiBlcnJvciBpbnN0YW5jZW9mIEFwcEVycm9yXG59XG5cbi8qKlxuICogU2FmZWx5IGV4dHJhY3QgZXJyb3IgbWVzc2FnZSBmcm9tIHVua25vd24gZXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZShlcnJvcjogdW5rbm93bik6IHN0cmluZyB7XG4gIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgcmV0dXJuIGVycm9yLm1lc3NhZ2VcbiAgfVxuICBpZiAodHlwZW9mIGVycm9yID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBlcnJvclxuICB9XG4gIHJldHVybiAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCdcbn1cblxuLyoqXG4gKiBTYWZlbHkgZXh0cmFjdCBlcnJvciBkZXRhaWxzIGZvciBsb2dnaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFcnJvckRldGFpbHMoZXJyb3I6IHVua25vd24pOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIGlmIChpc0FwcEVycm9yKGVycm9yKSkge1xuICAgIHJldHVybiB7XG4gICAgICBjb2RlOiBlcnJvci5jb2RlLFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIGRldGFpbHM6IGVycm9yLmRldGFpbHMsXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2ssXG4gICAgfVxuICB9XG4gIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgLy8gQ2hlY2sgZm9yIFN1cGFiYXNlIFBvc3RncmVzdEVycm9yIHdoaWNoIGV4dGVuZHMgRXJyb3IgYnV0IGhhcyBleHRyYSBmaWVsZHNcbiAgICBjb25zdCBzdXBhYmFzZUVycm9yID0gZXJyb3IgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICBpZiAoJ2NvZGUnIGluIGVycm9yICYmICdkZXRhaWxzJyBpbiBlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogZXJyb3IubmFtZSxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgY29kZTogc3VwYWJhc2VFcnJvci5jb2RlLFxuICAgICAgICBkZXRhaWxzOiBzdXBhYmFzZUVycm9yLmRldGFpbHMsXG4gICAgICAgIGhpbnQ6IHN1cGFiYXNlRXJyb3IuaGludCxcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogZXJyb3IubmFtZSxcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2ssXG4gICAgfVxuICB9XG4gIC8vIEhhbmRsZSBwbGFpbiBvYmplY3RzIChsaWtlIFN1cGFiYXNlIGVycm9yIHJlc3BvbnNlcyB0aGF0IGFyZW4ndCBFcnJvciBpbnN0YW5jZXMpXG4gIGlmICh0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmIGVycm9yICE9PSBudWxsKSB7XG4gICAgY29uc3Qgb2JqID0gZXJyb3IgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgLy8gQ2hlY2sgZm9yIFN1cGFiYXNlLXN0eWxlIGVycm9yIG9iamVjdHNcbiAgICBpZiAoJ2NvZGUnIGluIG9iaiB8fCAnbWVzc2FnZScgaW4gb2JqKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb2RlOiBvYmouY29kZSxcbiAgICAgICAgbWVzc2FnZTogb2JqLm1lc3NhZ2UsXG4gICAgICAgIGRldGFpbHM6IG9iai5kZXRhaWxzLFxuICAgICAgICBoaW50OiBvYmouaGludCxcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUmV0dXJuIHRoZSBvYmplY3QgYXMtaXMgZm9yIG90aGVyIHBsYWluIG9iamVjdHNcbiAgICB0cnkge1xuICAgICAgLy8gQXR0ZW1wdCB0byBzZXJpYWxpemUgLSBpZiBpdCBmYWlscywgZmFsbCBiYWNrIHRvIFN0cmluZ1xuICAgICAgSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4geyBlcnJvcjogU3RyaW5nKGVycm9yKSB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7IGVycm9yOiBTdHJpbmcoZXJyb3IpIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0IGFueSBlcnJvciB0byBhbiBBcHBFcnJvciBmb3IgY29uc2lzdGVudCBBUEkgcmVzcG9uc2VzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0FwcEVycm9yKGVycm9yOiB1bmtub3duKTogQXBwRXJyb3Ige1xuICBpZiAoaXNBcHBFcnJvcihlcnJvcikpIHtcbiAgICByZXR1cm4gZXJyb3JcbiAgfVxuXG4gIGNvbnN0IG1lc3NhZ2UgPSBnZXRFcnJvck1lc3NhZ2UoZXJyb3IpXG5cbiAgLy8gQ2hlY2sgZm9yIGNvbW1vbiBlcnJvciBwYXR0ZXJuc1xuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIC8vIFN1cGFiYXNlL1Bvc3RncmVTUUwgZXJyb3JzXG4gICAgaWYgKCdjb2RlJyBpbiBlcnJvciAmJiB0eXBlb2YgKGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5jb2RlID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgcGdDb2RlID0gKGVycm9yIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5jb2RlIGFzIHN0cmluZ1xuICAgICAgaWYgKHBnQ29kZSA9PT0gJzIzNTA1Jykge1xuICAgICAgICByZXR1cm4gbmV3IEFwcEVycm9yKEVycm9yQ29kZS5DT05GTElDVCwgJ1Jlc291cmNlIGFscmVhZHkgZXhpc3RzJywgeyBwZ0NvZGUgfSlcbiAgICAgIH1cbiAgICAgIGlmIChwZ0NvZGUgPT09ICcyMzUwMycpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBcHBFcnJvcihFcnJvckNvZGUuVkFMSURBVElPTl9FUlJPUiwgJ1JlZmVyZW5jZWQgcmVzb3VyY2Ugbm90IGZvdW5kJywgeyBwZ0NvZGUgfSlcbiAgICAgIH1cbiAgICAgIGlmIChwZ0NvZGUuc3RhcnRzV2l0aCgnNDInKSkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGFiYXNlRXJyb3IoJ0RhdGFiYXNlIHNjaGVtYSBlcnJvcicsIHsgcGdDb2RlIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBBcHBFcnJvcihFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsIG1lc3NhZ2UpXG59XG5cbi8qKlxuICogRm9ybWF0IGVycm9yIGZvciBOZXh0UmVzcG9uc2UgSlNPTlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RXJyb3JSZXNwb25zZShlcnJvcjogdW5rbm93bik6IHtcbiAgYm9keTogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgc3RhdHVzOiBudW1iZXJcbn0ge1xuICBjb25zdCBhcHBFcnJvciA9IHRvQXBwRXJyb3IoZXJyb3IpXG4gIHJldHVybiB7XG4gICAgYm9keTogYXBwRXJyb3IudG9KU09OKCksXG4gICAgc3RhdHVzOiBhcHBFcnJvci5zdGF0dXNDb2RlLFxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBMT0dHSU5HIEhFTFBFUlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogTG9nIGxldmVscyBmb3Igc3RydWN0dXJlZCBsb2dnaW5nXG4gKi9cbmV4cG9ydCB0eXBlIExvZ0xldmVsID0gJ2RlYnVnJyB8ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcidcblxuLyoqXG4gKiBTdHJ1Y3R1cmVkIGxvZyBlbnRyeVxuICovXG5leHBvcnQgaW50ZXJmYWNlIExvZ0VudHJ5IHtcbiAgbGV2ZWw6IExvZ0xldmVsXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgZXJyb3I/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICB0aW1lc3RhbXA6IHN0cmluZ1xufVxuXG4vKipcbiAqIFNpbXBsZSBzdHJ1Y3R1cmVkIGxvZ2dlclxuICogSW4gcHJvZHVjdGlvbiwgdGhpcyBzaG91bGQgYmUgcmVwbGFjZWQgd2l0aCBhIHByb3BlciBsb2dnaW5nIHNlcnZpY2VcbiAqL1xuZXhwb3J0IGNvbnN0IGxvZ2dlciA9IHtcbiAgZGVidWcobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoSlNPTi5zdHJpbmdpZnkoeyBsZXZlbDogJ2RlYnVnJywgbWVzc2FnZSwgY29udGV4dCwgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSkpXG4gICAgfVxuICB9LFxuXG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBjb25zb2xlLmluZm8oSlNPTi5zdHJpbmdpZnkoeyBsZXZlbDogJ2luZm8nLCBtZXNzYWdlLCBjb250ZXh0LCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KSlcbiAgfSxcblxuICB3YXJuKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gICAgY29uc29sZS53YXJuKEpTT04uc3RyaW5naWZ5KHsgbGV2ZWw6ICd3YXJuJywgbWVzc2FnZSwgY29udGV4dCwgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSkpXG4gIH0sXG5cbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBlcnJvcj86IHVua25vd24sIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIGNvbnN0IGVycm9yRGV0YWlscyA9IGVycm9yID8gZ2V0RXJyb3JEZXRhaWxzKGVycm9yKSA6IHVuZGVmaW5lZFxuICAgIGNvbnNvbGUuZXJyb3IoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbGV2ZWw6ICdlcnJvcicsXG4gICAgICBtZXNzYWdlLFxuICAgICAgZXJyb3I6IGVycm9yRGV0YWlscyxcbiAgICAgIGNvbnRleHQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0pKVxuICB9LFxufVxuIl0sIm5hbWVzIjpbIkVycm9yQ29kZSIsIkVSUk9SX1NUQVRVU19DT0RFUyIsIkFwcEVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsImNvZGUiLCJtZXNzYWdlIiwiZGV0YWlscyIsIm5hbWUiLCJzdGF0dXNDb2RlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJ0b0pTT04iLCJlcnJvciIsIlZhbGlkYXRpb25FcnJvciIsIk5vdEZvdW5kRXJyb3IiLCJyZXNvdXJjZSIsImlkZW50aWZpZXIiLCJVbmF1dGhvcml6ZWRFcnJvciIsIkZvcmJpZGRlbkVycm9yIiwiQ2FsY3VsYXRpb25FcnJvciIsIkFzc2Vzc21lbnRFcnJvciIsIkludmFsaWRTdGF0ZVRyYW5zaXRpb25FcnJvciIsImZyb20iLCJ0byIsIkRhdGFiYXNlRXJyb3IiLCJSYXRlTGltaXRFcnJvciIsInJldHJ5QWZ0ZXIiLCJpc0FwcEVycm9yIiwiZ2V0RXJyb3JNZXNzYWdlIiwiZ2V0RXJyb3JEZXRhaWxzIiwic3RhY2siLCJzdXBhYmFzZUVycm9yIiwiaGludCIsIm9iaiIsIkpTT04iLCJzdHJpbmdpZnkiLCJTdHJpbmciLCJ0b0FwcEVycm9yIiwicGdDb2RlIiwic3RhcnRzV2l0aCIsImZvcm1hdEVycm9yUmVzcG9uc2UiLCJhcHBFcnJvciIsImJvZHkiLCJzdGF0dXMiLCJsb2dnZXIiLCJkZWJ1ZyIsImNvbnRleHQiLCJwcm9jZXNzIiwiY29uc29sZSIsImxldmVsIiwiaW5mbyIsIndhcm4iLCJlcnJvckRldGFpbHMiLCJ1bmRlZmluZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/errors/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/logging/structured.ts":
/*!***************************************!*\
  !*** ./src/lib/logging/structured.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   configureLogger: () => (/* binding */ configureLogger),\n/* harmony export */   createRequestLogger: () => (/* binding */ createRequestLogger),\n/* harmony export */   getRequestMetadata: () => (/* binding */ getRequestMetadata),\n/* harmony export */   log: () => (/* binding */ log),\n/* harmony export */   withRequestLogging: () => (/* binding */ withRequestLogging)\n/* harmony export */ });\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors/index.ts\");\n// =====================================================\n// FILE: src/lib/logging/structured.ts\n// PURPOSE: Production-grade structured logging with correlation IDs\n// Phase B: Observability Infrastructure\n// =====================================================\n\nconst LOG_LEVEL_PRIORITY = {\n    debug: 0,\n    info: 1,\n    warn: 2,\n    error: 3\n};\n/**\n * Global logger configuration\n */ const globalConfig = {\n    serviceName: \"ifa-platform\",\n    environment: \"development\" || 0,\n    minLevel:  false ? 0 : \"debug\"\n};\n/**\n * Format and output a log entry\n */ function outputLog(entry) {\n    const minPriority = LOG_LEVEL_PRIORITY[globalConfig.minLevel || \"debug\"];\n    const entryPriority = LOG_LEVEL_PRIORITY[entry.level];\n    if (entryPriority < minPriority) {\n        return;\n    }\n    const logObject = {\n        ...entry,\n        service: globalConfig.serviceName,\n        env: globalConfig.environment\n    };\n    const logString = JSON.stringify(logObject);\n    switch(entry.level){\n        case \"debug\":\n            console.debug(logString);\n            break;\n        case \"info\":\n            console.info(logString);\n            break;\n        case \"warn\":\n            console.warn(logString);\n            break;\n        case \"error\":\n            console.error(logString);\n            break;\n    }\n}\n/**\n * Create a request-scoped logger with correlation ID\n * Use this in API routes to correlate all logs for a single request\n */ function createRequestLogger(request) {\n    // Generate or extract request ID\n    const requestId = request?.headers.get(\"x-request-id\") || request?.headers.get(\"x-correlation-id\") || crypto.randomUUID();\n    const startTime = Date.now();\n    const createEntry = (level, message, context, error)=>({\n            level,\n            message,\n            requestId,\n            timestamp: new Date().toISOString(),\n            durationMs: Date.now() - startTime,\n            context,\n            error: error ? (0,_lib_errors__WEBPACK_IMPORTED_MODULE_0__.getErrorDetails)(error) : undefined\n        });\n    return {\n        requestId,\n        startTime,\n        debug (message, context) {\n            outputLog(createEntry(\"debug\", message, context));\n        },\n        info (message, context) {\n            outputLog(createEntry(\"info\", message, context));\n        },\n        warn (message, context) {\n            outputLog(createEntry(\"warn\", message, context));\n        },\n        error (message, error, context) {\n            outputLog(createEntry(\"error\", message, context, error));\n        },\n        duration () {\n            return Date.now() - startTime;\n        },\n        logRequestComplete (statusCode, context) {\n            const duration = Date.now() - startTime;\n            const level = statusCode >= 500 ? \"error\" : statusCode >= 400 ? \"warn\" : \"info\";\n            outputLog(createEntry(level, \"Request completed\", {\n                ...context,\n                statusCode,\n                durationMs: duration\n            }));\n        }\n    };\n}\n/**\n * Extract useful request metadata for logging\n */ function getRequestMetadata(request) {\n    const url = new URL(request.url);\n    return {\n        method: request.method,\n        path: url.pathname,\n        query: Object.fromEntries(url.searchParams),\n        userAgent: request.headers.get(\"user-agent\")?.slice(0, 100),\n        ip: request.headers.get(\"x-forwarded-for\")?.split(\",\")[0]?.trim() || request.headers.get(\"x-real-ip\") || \"unknown\"\n    };\n}\n/**\n * Standalone logger for non-request contexts (services, jobs, etc.)\n */ const log = {\n    debug (message, context) {\n        outputLog({\n            level: \"debug\",\n            message,\n            timestamp: new Date().toISOString(),\n            context\n        });\n    },\n    info (message, context) {\n        outputLog({\n            level: \"info\",\n            message,\n            timestamp: new Date().toISOString(),\n            context\n        });\n    },\n    warn (message, context) {\n        outputLog({\n            level: \"warn\",\n            message,\n            timestamp: new Date().toISOString(),\n            context\n        });\n    },\n    error (message, error, context) {\n        outputLog({\n            level: \"error\",\n            message,\n            timestamp: new Date().toISOString(),\n            context,\n            error: error ? (0,_lib_errors__WEBPACK_IMPORTED_MODULE_0__.getErrorDetails)(error) : undefined\n        });\n    }\n};\n/**\n * Configure global logger settings\n */ function configureLogger(config) {\n    Object.assign(globalConfig, config);\n}\n/**\n * Higher-order function to wrap API route handlers with logging\n */ function withRequestLogging(handler) {\n    return async (request)=>{\n        const logger = createRequestLogger(request);\n        const metadata = getRequestMetadata(request);\n        logger.info(\"Request started\", metadata);\n        try {\n            const result = await handler(request, logger);\n            return result;\n        } catch (error) {\n            logger.error(\"Request failed\", error, metadata);\n            throw error;\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBRXBFLE9BQU8sT0FBT3ZDO1FBQ1osTUFBTXdDLFNBQVN6QyxvQkFBb0JDO1FBQ25DLE1BQU15QyxXQUFXdEIsbUJBQW1CbkI7UUFFcEN3QyxPQUFPN0QsSUFBSSxDQUFDLG1CQUFtQjhEO1FBRS9CLElBQUk7WUFDRixNQUFNQyxTQUFTLE1BQU1ILFFBQVF2QyxTQUFTd0M7WUFDdEMsT0FBT0U7UUFDVCxFQUFFLE9BQU83RCxPQUFPO1lBQ2QyRCxPQUFPM0QsS0FBSyxDQUFDLGtCQUFrQkEsT0FBTzREO1lBQ3RDLE1BQU01RDtRQUNSO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BsYW5uZXRpYy1wbGF0Zm9ybS8uL3NyYy9saWIvbG9nZ2luZy9zdHJ1Y3R1cmVkLnRzP2JiOGMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZJTEU6IHNyYy9saWIvbG9nZ2luZy9zdHJ1Y3R1cmVkLnRzXG4vLyBQVVJQT1NFOiBQcm9kdWN0aW9uLWdyYWRlIHN0cnVjdHVyZWQgbG9nZ2luZyB3aXRoIGNvcnJlbGF0aW9uIElEc1xuLy8gUGhhc2UgQjogT2JzZXJ2YWJpbGl0eSBJbmZyYXN0cnVjdHVyZVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGdldEVycm9yRGV0YWlscyB9IGZyb20gJ0AvbGliL2Vycm9ycydcblxuLyoqXG4gKiBMb2cgbGV2ZWxzIGZvciBzdHJ1Y3R1cmVkIGxvZ2dpbmdcbiAqL1xuZXhwb3J0IHR5cGUgTG9nTGV2ZWwgPSAnZGVidWcnIHwgJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJ1xuXG4vKipcbiAqIFN0cnVjdHVyZWQgbG9nIGVudHJ5IGZvcm1hdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIExvZ0VudHJ5IHtcbiAgbGV2ZWw6IExvZ0xldmVsXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICByZXF1ZXN0SWQ/OiBzdHJpbmdcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgZHVyYXRpb25Ncz86IG51bWJlclxuICBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgZXJyb3I/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxufVxuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gZm9yIHRoZSBsb2dnZXJcbiAqL1xuaW50ZXJmYWNlIExvZ2dlckNvbmZpZyB7XG4gIHNlcnZpY2VOYW1lPzogc3RyaW5nXG4gIGVudmlyb25tZW50Pzogc3RyaW5nXG4gIG1pbkxldmVsPzogTG9nTGV2ZWxcbn1cblxuY29uc3QgTE9HX0xFVkVMX1BSSU9SSVRZOiBSZWNvcmQ8TG9nTGV2ZWwsIG51bWJlcj4gPSB7XG4gIGRlYnVnOiAwLFxuICBpbmZvOiAxLFxuICB3YXJuOiAyLFxuICBlcnJvcjogM1xufVxuXG4vKipcbiAqIEdsb2JhbCBsb2dnZXIgY29uZmlndXJhdGlvblxuICovXG5jb25zdCBnbG9iYWxDb25maWc6IExvZ2dlckNvbmZpZyA9IHtcbiAgc2VydmljZU5hbWU6ICdpZmEtcGxhdGZvcm0nLFxuICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50JyxcbiAgbWluTGV2ZWw6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnaW5mbycgOiAnZGVidWcnXG59XG5cbi8qKlxuICogRm9ybWF0IGFuZCBvdXRwdXQgYSBsb2cgZW50cnlcbiAqL1xuZnVuY3Rpb24gb3V0cHV0TG9nKGVudHJ5OiBMb2dFbnRyeSk6IHZvaWQge1xuICBjb25zdCBtaW5Qcmlvcml0eSA9IExPR19MRVZFTF9QUklPUklUWVtnbG9iYWxDb25maWcubWluTGV2ZWwgfHwgJ2RlYnVnJ11cbiAgY29uc3QgZW50cnlQcmlvcml0eSA9IExPR19MRVZFTF9QUklPUklUWVtlbnRyeS5sZXZlbF1cblxuICBpZiAoZW50cnlQcmlvcml0eSA8IG1pblByaW9yaXR5KSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICBjb25zdCBsb2dPYmplY3QgPSB7XG4gICAgLi4uZW50cnksXG4gICAgc2VydmljZTogZ2xvYmFsQ29uZmlnLnNlcnZpY2VOYW1lLFxuICAgIGVudjogZ2xvYmFsQ29uZmlnLmVudmlyb25tZW50XG4gIH1cblxuICBjb25zdCBsb2dTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShsb2dPYmplY3QpXG5cbiAgc3dpdGNoIChlbnRyeS5sZXZlbCkge1xuICAgIGNhc2UgJ2RlYnVnJzpcbiAgICAgIGNvbnNvbGUuZGVidWcobG9nU3RyaW5nKVxuICAgICAgYnJlYWtcbiAgICBjYXNlICdpbmZvJzpcbiAgICAgIGNvbnNvbGUuaW5mbyhsb2dTdHJpbmcpXG4gICAgICBicmVha1xuICAgIGNhc2UgJ3dhcm4nOlxuICAgICAgY29uc29sZS53YXJuKGxvZ1N0cmluZylcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnZXJyb3InOlxuICAgICAgY29uc29sZS5lcnJvcihsb2dTdHJpbmcpXG4gICAgICBicmVha1xuICB9XG59XG5cbi8qKlxuICogUmVxdWVzdC1zY29wZWQgbG9nZ2VyIHdpdGggY29ycmVsYXRpb24gSURcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0TG9nZ2VyIHtcbiAgcmVxdWVzdElkOiBzdHJpbmdcbiAgc3RhcnRUaW1lOiBudW1iZXJcblxuICBkZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHZvaWRcbiAgaW5mbyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHZvaWRcbiAgd2FybihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHZvaWRcbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBlcnJvcj86IHVua25vd24sIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHZvaWRcblxuICAvKiogR2V0IGVsYXBzZWQgdGltZSBpbiBtaWxsaXNlY29uZHMgKi9cbiAgZHVyYXRpb24oKTogbnVtYmVyXG5cbiAgLyoqIExvZyByZXF1ZXN0IGNvbXBsZXRpb24gd2l0aCB0aW1pbmcgKi9cbiAgbG9nUmVxdWVzdENvbXBsZXRlKHN0YXR1c0NvZGU6IG51bWJlciwgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogdm9pZFxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHJlcXVlc3Qtc2NvcGVkIGxvZ2dlciB3aXRoIGNvcnJlbGF0aW9uIElEXG4gKiBVc2UgdGhpcyBpbiBBUEkgcm91dGVzIHRvIGNvcnJlbGF0ZSBhbGwgbG9ncyBmb3IgYSBzaW5nbGUgcmVxdWVzdFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVxdWVzdExvZ2dlcihyZXF1ZXN0PzogTmV4dFJlcXVlc3QpOiBSZXF1ZXN0TG9nZ2VyIHtcbiAgLy8gR2VuZXJhdGUgb3IgZXh0cmFjdCByZXF1ZXN0IElEXG4gIGNvbnN0IHJlcXVlc3RJZCA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KCd4LXJlcXVlc3QtaWQnKVxuICAgIHx8IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KCd4LWNvcnJlbGF0aW9uLWlkJylcbiAgICB8fCBjcnlwdG8ucmFuZG9tVVVJRCgpXG5cbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKVxuXG4gIGNvbnN0IGNyZWF0ZUVudHJ5ID0gKFxuICAgIGxldmVsOiBMb2dMZXZlbCxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICAgIGVycm9yPzogdW5rbm93blxuICApOiBMb2dFbnRyeSA9PiAoe1xuICAgIGxldmVsLFxuICAgIG1lc3NhZ2UsXG4gICAgcmVxdWVzdElkLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIGR1cmF0aW9uTXM6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgY29udGV4dCxcbiAgICBlcnJvcjogZXJyb3IgPyBnZXRFcnJvckRldGFpbHMoZXJyb3IpIDogdW5kZWZpbmVkXG4gIH0pXG5cbiAgcmV0dXJuIHtcbiAgICByZXF1ZXN0SWQsXG4gICAgc3RhcnRUaW1lLFxuXG4gICAgZGVidWcobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICAgIG91dHB1dExvZyhjcmVhdGVFbnRyeSgnZGVidWcnLCBtZXNzYWdlLCBjb250ZXh0KSlcbiAgICB9LFxuXG4gICAgaW5mbyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgICAgb3V0cHV0TG9nKGNyZWF0ZUVudHJ5KCdpbmZvJywgbWVzc2FnZSwgY29udGV4dCkpXG4gICAgfSxcblxuICAgIHdhcm4obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICAgIG91dHB1dExvZyhjcmVhdGVFbnRyeSgnd2FybicsIG1lc3NhZ2UsIGNvbnRleHQpKVxuICAgIH0sXG5cbiAgICBlcnJvcihtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogdW5rbm93biwgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gICAgICBvdXRwdXRMb2coY3JlYXRlRW50cnkoJ2Vycm9yJywgbWVzc2FnZSwgY29udGV4dCwgZXJyb3IpKVxuICAgIH0sXG5cbiAgICBkdXJhdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgfSxcblxuICAgIGxvZ1JlcXVlc3RDb21wbGV0ZShzdGF0dXNDb2RlOiBudW1iZXIsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICBjb25zdCBsZXZlbDogTG9nTGV2ZWwgPSBzdGF0dXNDb2RlID49IDUwMCA/ICdlcnJvcicgOiBzdGF0dXNDb2RlID49IDQwMCA/ICd3YXJuJyA6ICdpbmZvJ1xuXG4gICAgICBvdXRwdXRMb2coY3JlYXRlRW50cnkobGV2ZWwsICdSZXF1ZXN0IGNvbXBsZXRlZCcsIHtcbiAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgc3RhdHVzQ29kZSxcbiAgICAgICAgZHVyYXRpb25NczogZHVyYXRpb25cbiAgICAgIH0pKVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEV4dHJhY3QgdXNlZnVsIHJlcXVlc3QgbWV0YWRhdGEgZm9yIGxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlcXVlc3RNZXRhZGF0YShyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcblxuICByZXR1cm4ge1xuICAgIG1ldGhvZDogcmVxdWVzdC5tZXRob2QsXG4gICAgcGF0aDogdXJsLnBhdGhuYW1lLFxuICAgIHF1ZXJ5OiBPYmplY3QuZnJvbUVudHJpZXModXJsLnNlYXJjaFBhcmFtcyksXG4gICAgdXNlckFnZW50OiByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50Jyk/LnNsaWNlKDAsIDEwMCksXG4gICAgaXA6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpPy5zcGxpdCgnLCcpWzBdPy50cmltKClcbiAgICAgIHx8IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpXG4gICAgICB8fCAndW5rbm93bidcbiAgfVxufVxuXG4vKipcbiAqIFN0YW5kYWxvbmUgbG9nZ2VyIGZvciBub24tcmVxdWVzdCBjb250ZXh0cyAoc2VydmljZXMsIGpvYnMsIGV0Yy4pXG4gKi9cbmV4cG9ydCBjb25zdCBsb2cgPSB7XG4gIGRlYnVnKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gICAgb3V0cHV0TG9nKHtcbiAgICAgIGxldmVsOiAnZGVidWcnLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgY29udGV4dFxuICAgIH0pXG4gIH0sXG5cbiAgaW5mbyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIG91dHB1dExvZyh7XG4gICAgICBsZXZlbDogJ2luZm8nLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgY29udGV4dFxuICAgIH0pXG4gIH0sXG5cbiAgd2FybihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIG91dHB1dExvZyh7XG4gICAgICBsZXZlbDogJ3dhcm4nLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgY29udGV4dFxuICAgIH0pXG4gIH0sXG5cbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBlcnJvcj86IHVua25vd24sIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIG91dHB1dExvZyh7XG4gICAgICBsZXZlbDogJ2Vycm9yJyxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGNvbnRleHQsXG4gICAgICBlcnJvcjogZXJyb3IgPyBnZXRFcnJvckRldGFpbHMoZXJyb3IpIDogdW5kZWZpbmVkXG4gICAgfSlcbiAgfVxufVxuXG4vKipcbiAqIENvbmZpZ3VyZSBnbG9iYWwgbG9nZ2VyIHNldHRpbmdzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmVMb2dnZXIoY29uZmlnOiBQYXJ0aWFsPExvZ2dlckNvbmZpZz4pOiB2b2lkIHtcbiAgT2JqZWN0LmFzc2lnbihnbG9iYWxDb25maWcsIGNvbmZpZylcbn1cblxuLyoqXG4gKiBIaWdoZXItb3JkZXIgZnVuY3Rpb24gdG8gd3JhcCBBUEkgcm91dGUgaGFuZGxlcnMgd2l0aCBsb2dnaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUmVxdWVzdExvZ2dpbmc8VD4oXG4gIGhhbmRsZXI6IChyZXF1ZXN0OiBOZXh0UmVxdWVzdCwgbG9nZ2VyOiBSZXF1ZXN0TG9nZ2VyKSA9PiBQcm9taXNlPFQ+XG4pIHtcbiAgcmV0dXJuIGFzeW5jIChyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8VD4gPT4ge1xuICAgIGNvbnN0IGxvZ2dlciA9IGNyZWF0ZVJlcXVlc3RMb2dnZXIocmVxdWVzdClcbiAgICBjb25zdCBtZXRhZGF0YSA9IGdldFJlcXVlc3RNZXRhZGF0YShyZXF1ZXN0KVxuXG4gICAgbG9nZ2VyLmluZm8oJ1JlcXVlc3Qgc3RhcnRlZCcsIG1ldGFkYXRhKVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIocmVxdWVzdCwgbG9nZ2VyKVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ1JlcXVlc3QgZmFpbGVkJywgZXJyb3IsIG1ldGFkYXRhKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJnZXRFcnJvckRldGFpbHMiLCJMT0dfTEVWRUxfUFJJT1JJVFkiLCJkZWJ1ZyIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJnbG9iYWxDb25maWciLCJzZXJ2aWNlTmFtZSIsImVudmlyb25tZW50IiwicHJvY2VzcyIsIm1pbkxldmVsIiwib3V0cHV0TG9nIiwiZW50cnkiLCJtaW5Qcmlvcml0eSIsImVudHJ5UHJpb3JpdHkiLCJsZXZlbCIsImxvZ09iamVjdCIsInNlcnZpY2UiLCJlbnYiLCJsb2dTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwiY29uc29sZSIsImNyZWF0ZVJlcXVlc3RMb2dnZXIiLCJyZXF1ZXN0IiwicmVxdWVzdElkIiwiaGVhZGVycyIsImdldCIsImNyeXB0byIsInJhbmRvbVVVSUQiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwiY3JlYXRlRW50cnkiLCJtZXNzYWdlIiwiY29udGV4dCIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiZHVyYXRpb25NcyIsInVuZGVmaW5lZCIsImR1cmF0aW9uIiwibG9nUmVxdWVzdENvbXBsZXRlIiwic3RhdHVzQ29kZSIsImdldFJlcXVlc3RNZXRhZGF0YSIsInVybCIsIlVSTCIsIm1ldGhvZCIsInBhdGgiLCJwYXRobmFtZSIsInF1ZXJ5IiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJzZWFyY2hQYXJhbXMiLCJ1c2VyQWdlbnQiLCJzbGljZSIsImlwIiwic3BsaXQiLCJ0cmltIiwibG9nIiwiY29uZmlndXJlTG9nZ2VyIiwiY29uZmlnIiwiYXNzaWduIiwid2l0aFJlcXVlc3RMb2dnaW5nIiwiaGFuZGxlciIsImxvZ2dlciIsIm1ldGFkYXRhIiwicmVzdWx0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/logging/structured.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nasync function createClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://maandodhonjolrmcxivo.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1hYW5kb2Rob25qb2xybWN4aXZvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1NDg3NjIsImV4cCI6MjA2NDEyNDc2Mn0.Ku89ldqO_b1ptFBQFtQPhzmmnrg04LpcMeCw21sjlAE\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>{\n                        cookieStore.set(name, value, options);\n                    });\n                } catch  {\n                // Server components can't set cookies\n                }\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBa0Q7QUFDWjtBQUcvQixlQUFlRTtJQUNwQixNQUFNQyxjQUFjLE1BQU1GLHFEQUFPQTtJQUVqQyxPQUFPRCxpRUFBa0JBLENBQ3ZCSSwwQ0FBb0MsRUFDcENBLGtOQUF5QyxFQUN6QztRQUNFSCxTQUFTO1lBQ1BPO2dCQUNFLE9BQU9MLFlBQVlLLE1BQU07WUFDM0I7WUFDQUMsUUFBT0MsWUFBNkQ7Z0JBQ2xFLElBQUk7b0JBQ0ZBLGFBQWFDLE9BQU8sQ0FBQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUU7d0JBQzVDWCxZQUFZWSxHQUFHLENBQUNILE1BQU1DLE9BQU9DO29CQUMvQjtnQkFDRixFQUFFLE9BQU07Z0JBQ04sc0NBQXNDO2dCQUN4QztZQUNGO1FBQ0Y7SUFDRjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGxhbm5ldGljLXBsYXRmb3JtLy4vc3JjL2xpYi9zdXBhYmFzZS9zZXJ2ZXIudHM/MmU4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJ1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB0eXBlIHsgRGF0YWJhc2UgfSBmcm9tICdAL3R5cGVzL2RiJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KCkge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQ8RGF0YWJhc2U+KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0QWxsKCkge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuICAgICAgICB9LFxuICAgICAgICBzZXRBbGwoY29va2llc1RvU2V0OiB7IG5hbWU6IHN0cmluZzsgdmFsdWU6IHN0cmluZzsgb3B0aW9uczogYW55IH1bXSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb29raWVzVG9TZXQuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSwgb3B0aW9ucyB9KSA9PiB7XG4gICAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChuYW1lLCB2YWx1ZSwgb3B0aW9ucylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAvLyBTZXJ2ZXIgY29tcG9uZW50cyBjYW4ndCBzZXQgY29va2llc1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApXG59Il0sIm5hbWVzIjpbImNyZWF0ZVNlcnZlckNsaWVudCIsImNvb2tpZXMiLCJjcmVhdGVDbGllbnQiLCJjb29raWVTdG9yZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImdldEFsbCIsInNldEFsbCIsImNvb2tpZXNUb1NldCIsImZvckVhY2giLCJuYW1lIiwidmFsdWUiLCJvcHRpb25zIiwic2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/cookie","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Factivity-log%2Froute&page=%2Fapi%2Factivity-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Factivity-log%2Froute.ts&appDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fadeomosanya%2FDocuments%2Fifa-professional-portal%2Fifa-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();