import React from 'react'
import { Page, Text, View } from '@react-pdf/renderer'
import type { SuitabilityReportData } from '@/lib/suitability/reporting/types'
import { PageFooter } from '@/lib/pdf-templates/suitability-report-internals/components/PageFooter'

export const VulnerabilityPage: React.FC<{ data: SuitabilityReportData; styles: any; brand: any }> = ({
  data,
  styles,
  brand
}) => (
  <Page size="A4" style={styles.page}>
    <View style={styles.header}>
      <View style={styles.headerRow}>
        <Text style={styles.firmName}>{brand.firmName}</Text>
        <Text style={styles.footerText}>Suitability Report</Text>
      </View>
    </View>

    <View style={styles.section}>
      <Text style={styles.sectionTitle}>Vulnerability Assessment</Text>
      <Text style={styles.text}>
        Under FCA Consumer Duty requirements, we are required to consider whether you may be in a vulnerable circumstance
        and, if so, to ensure our service and recommendations are appropriately tailored.
      </Text>

      <View
        style={[
          data.vulnerabilityAssessment.hasVulnerability ? styles.warningCard : styles.successCard,
          { marginTop: 12 }
        ]}
      >
        <Text style={styles.boldText}>
          Assessment Result:{' '}
          {data.vulnerabilityAssessment.hasVulnerability
            ? 'Potential vulnerability indicators identified'
            : 'No vulnerability indicators identified'}
        </Text>
      </View>

      {data.vulnerabilityAssessment.texasAssessment && (
        <View style={styles.subsection}>
          <Text style={styles.subsectionTitle}>TEXAS Assessment</Text>
          <Text style={styles.text}>We use the TEXAS model to identify and understand potential vulnerabilities:</Text>

          <View style={styles.card}>
            <View style={styles.bulletList}>
              <View style={styles.bulletItem}>
                <Text style={styles.bullet}>T</Text>
                <View style={{ flex: 1 }}>
                  <Text style={styles.boldText}>Thinking - Cognitive impairments</Text>
                  <Text style={styles.text}>
                    {data.vulnerabilityAssessment.texasAssessment.thinking || 'No concerns identified'}
                  </Text>
                </View>
              </View>
              <View style={styles.bulletItem}>
                <Text style={styles.bullet}>E</Text>
                <View style={{ flex: 1 }}>
                  <Text style={styles.boldText}>Emotions - Emotional state</Text>
                  <Text style={styles.text}>
                    {data.vulnerabilityAssessment.texasAssessment.emotions || 'No concerns identified'}
                  </Text>
                </View>
              </View>
              <View style={styles.bulletItem}>
                <Text style={styles.bullet}>X</Text>
                <View style={{ flex: 1 }}>
                  <Text style={styles.boldText}>eXperience - Life events</Text>
                  <Text style={styles.text}>
                    {data.vulnerabilityAssessment.texasAssessment.experience || 'No concerns identified'}
                  </Text>
                </View>
              </View>
              <View style={styles.bulletItem}>
                <Text style={styles.bullet}>A</Text>
                <View style={{ flex: 1 }}>
                  <Text style={styles.boldText}>Action - Ability to take action</Text>
                  <Text style={styles.text}>
                    {data.vulnerabilityAssessment.texasAssessment.action || 'No concerns identified'}
                  </Text>
                </View>
              </View>
              <View style={styles.bulletItem}>
                <Text style={styles.bullet}>S</Text>
                <View style={{ flex: 1 }}>
                  <Text style={styles.boldText}>Support - Support network</Text>
                  <Text style={styles.text}>
                    {data.vulnerabilityAssessment.texasAssessment.support || 'No concerns identified'}
                  </Text>
                </View>
              </View>
            </View>
          </View>
        </View>
      )}

      {data.vulnerabilityAssessment.accommodations && data.vulnerabilityAssessment.accommodations.length > 0 && (
        <View style={styles.subsection}>
          <Text style={styles.subsectionTitle}>Accommodations Made</Text>
          <View style={styles.bulletList}>
            {data.vulnerabilityAssessment.accommodations.map((accommodation, index) => (
              <View key={index} style={styles.bulletItem}>
                <Text style={styles.bullet}>-</Text>
                <Text style={styles.bulletText}>{accommodation}</Text>
              </View>
            ))}
          </View>
        </View>
      )}
    </View>

    <PageFooter styles={styles} brand={brand} />
  </Page>
)

